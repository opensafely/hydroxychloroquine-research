-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  E:\analyses\hydroxychloroquine-research/output/log\04_an_descripti
> ve_table.log
  log type:  text
 opened on:  19 Aug 2020, 16:53:46

. 
. * Open Stata dataset
. use $Tempdir\analysis_dataset, clear

. 
. /* PROGRAMS TO AUTOMATE TABULATIONS==========================================
> =*/ 
. 
. *****************************************************************************
> ***
. * All below code from K Baskharan 
. * Generic code to output one row of table
. 
. cap prog drop generaterow

. program define generaterow
  1. syntax, variable(varname) condition(string) 
  2.         
.         cou
  3.         local overalldenom=r(N)
  4.         
.         qui sum `variable' if `variable' `condition'
  5.         file write tablecontent (r(max)) _tab
  6.         
.         cou if `variable' `condition'
  7.         local rowdenom = r(N)
  8.         local colpct = 100*(r(N)/`overalldenom')
  9.         file write tablecontent %9.0gc (`rowdenom')  (" (") %3.1f (`colpct
> ') (")") _tab
 10. 
.         cou if exposure == 0 
 11.         local rowdenom = r(N)
 12.         cou if exposure == 0 & `variable' `condition'
 13.         local pct = 100*(r(N)/`rowdenom') 
 14.         file write tablecontent %9.0gc (r(N)) (" (") %3.1f (`pct') (")") _
> tab
 15. 
.         cou if exposure == 1 
 16.         local rowdenom = r(N)
 17.         cou if exposure == 1 & `variable' `condition'
 18.         local pct = 100*(r(N)/`rowdenom')
 19.         file write tablecontent %9.0gc (r(N)) (" (") %3.1f  (`pct') (")") 
> _tab
 20. 
.         cou if exposure >= .
 21.         local rowdenom = r(N)
 22.         cou if exposure >= . & `variable' `condition'
 23.         local pct = 100*(r(N)/`rowdenom')
 24.         file write tablecontent %9.0gc (r(N)) (" (") %3.1f (`pct') (")") _
> n
 25.         
. end

. 
. /* Explanatory Notes 
> 
> defines a program (SAS macro/R function equivalent), generate row
> the syntax row specifies two inputs for the program: 
> 
>         a VARNAME which is your variable 
>         a CONDITION which is a string of some condition you impose 
>         
> the program counts if variable and condition and returns the counts
> column percentages are then automatically generated
> this is then written to the text file 'tablecontent' 
> the number followed by space, brackets, formatted pct, end bracket and then t
> ab
> 
> the format %3.1f specifies length of 3, followed by 1 dp. 
> 
> */ 
. 
. *****************************************************************************
> ***
. * Generic code to output one section (varible) within table (calls above)
. 
. cap prog drop tabulatevariable

. prog define tabulatevariable
  1. syntax, variable(varname) min(real) max(real) [missing]
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4. 
.         forvalues varlevel = `min'/`max'{ 
  5.                 generaterow, variable(`variable') condition("==`varlevel'"
> )
  6.         }
  7.         
.         if "`missing'"!="" generaterow, variable(`variable') condition(">=.")
  8. 
. end

. 
. *****************************************************************************
> ***
. 
. /* Explanatory Notes 
> 
> defines program tabulate variable 
> syntax is : 
> 
>         - a VARNAME which you stick in variable 
>         - a numeric minimum 
>         - a numeric maximum 
>         - optional missing option, default value is . 
> 
> forvalues lowest to highest of the variable, manually set for each var
> run the generate row program for the level of the variable 
> if there is a missing specified, then run the generate row for missing vals
> 
> */ 
. 
. *****************************************************************************
> ***
. * Generic code to summarize a continous variable 
. 
. cap prog drop summarizevariable 

. prog define summarizevariable
  1. syntax, variable(varname) 
  2. 
.         local lab: variable label `variable'
  3.         file write tablecontent ("`lab'") _n 
  4.         
.         qui summarize `variable', d
  5.         file write tablecontent ("Median (IQR)") _tab 
  6.         file write tablecontent (r(p50)) (" (") (r(p25)) ("-") (r(p75)) ("
> )") _tab
  7.                                                         
.         qui summarize `variable' if exposure == 0, d
  8.         file write tablecontent (r(p50)) (" (") (r(p25)) ("-") (r(p75)) ("
> )") _tab
  9. 
.         qui summarize `variable' if exposure == 1, d
 10.         file write tablecontent (r(p50)) (" (") (r(p25)) ("-") (r(p75)) ("
> )") _tab
 11.         
.         qui summarize `variable' if exposure >= ., d
 12.         file write tablecontent (r(p50)) (" (") (r(p25)) ("-") (r(p75)) ("
> )") _n
 13.         
.         qui summarize `variable', d
 14.         file write tablecontent ("Mean (SD)") _tab 
 15.         file write tablecontent (r(mean)) (" (") (r(sd)) (")") _tab
 16.                                                         
.         qui summarize `variable' if exposure == 0, d
 17.         file write tablecontent (r(mean)) (" (") (r(sd)) (")") _tab
 18. 
.         qui summarize `variable' if exposure == 1, d
 19.         file write tablecontent (r(mean)) (" (") (r(sd)) (")") _tab
 20.         
.         qui summarize `variable' if exposure >= ., d
 21.         file write tablecontent (r(mean)) (" (") (r(sd))  (")") _n
 22.         
.         
.         qui summarize `variable', d
 23.         file write tablecontent ("Min, Max") _tab 
 24.         file write tablecontent (r(min)) (", ") (r(max)) ("") _tab
 25.                                                         
.         qui summarize `variable' if exposure == 0, d
 26.         file write tablecontent (r(min)) (", ") (r(max)) ("") _tab
 27. 
.         qui summarize `variable' if exposure == 1, d
 28.         file write tablecontent (r(min)) (", ") (r(max)) ("") _tab
 29.         
.         qui summarize `variable' if exposure >= ., d
 30.         file write tablecontent (r(min)) (", ") (r(max)) ("") _n
 31.         
. end

. 
. 
. /* INVOKE PROGRAMS FOR TABLE 1===============================================
> =*/ 
. 
. *Set up output file
. cap file close tablecontent

. file open tablecontent using $Tabfigdir/table1.txt, write text replace

. 
. file write tablecontent ("Table 1: Demographic and Clinical Characteristics")
>  _n

. 
. * Exposure labelled columns
. 
. local lab0: label exposure 0

. local lab1: label exposure 1

. local labu: label exposure .u

. 
. 
. file write tablecontent _tab ("Total")                                       
>              _tab ///
>                                                          ("`lab0'")          
>                                          _tab ///
>                                                          ("`lab1'")          
>                                      _tab ///
>                                                          ("`labu'")          
>                                              _n 

. 
. * DEMOGRAPHICS (more than one level, potentially missing) 
. 
. gen byte cons=1

. tabulatevariable, variable(cons) min(1) max(1) 
  194,637
  194,637
  164,068
  164,068
  30,569
  30,569
  0
  0

. file write tablecontent _n 

. 
. /* POPULATION */
. tabulatevariable, variable(population) min(0) max(1) 
  194,637
  167,874
  164,068
  144,151
  30,569
  23,723
  0
  0
  194,637
  26,763
  164,068
  19,917
  30,569
  6,846
  0
  0

. file write tablecontent _n 

. 
. /* SOCIO-DEMOGRAPHICS */
. tabulatevariable, variable(agegroup) min(1) max(6) 
  194,637
  13,709
  164,068
  11,433
  30,569
  2,276
  0
  0
  194,637
  19,438
  164,068
  15,829
  30,569
  3,609
  0
  0
  194,637
  37,086
  164,068
  30,457
  30,569
  6,629
  0
  0
  194,637
  45,699
  164,068
  37,726
  30,569
  7,973
  0
  0
  194,637
  49,238
  164,068
  42,090
  30,569
  7,148
  0
  0
  194,637
  29,467
  164,068
  26,533
  30,569
  2,934
  0
  0

. file write tablecontent _n 

. 
. summarizevariable, variable(age)

. file write tablecontent _n 

. 
. tabulatevariable, variable(male) min(0) max(1) 
  194,637
  138,440
  164,068
  115,106
  30,569
  23,334
  0
  0
  194,637
  56,197
  164,068
  48,962
  30,569
  7,235
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(ethnicity) min(1) max(5) missing 
  194,637
  132,697
  164,068
  112,367
  30,569
  20,330
  0
  0
  194,637
  10,498
  164,068
  8,502
  30,569
  1,996
  0
  0
  194,637
  2,997
  164,068
  2,425
  30,569
  572
  0
  0
  194,637
  1,279
  164,068
  1,005
  30,569
  274
  0
  0
  194,637
  1,838
  164,068
  1,508
  30,569
  330
  0
  0
  194,637
  45,328
  164,068
  38,261
  30,569
  7,067
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(imd) min(1) max(5) missing
  194,637
  38,968
  164,068
  32,954
  30,569
  6,014
  0
  0
  194,637
  39,437
  164,068
  33,351
  30,569
  6,086
  0
  0
  194,637
  38,942
  164,068
  32,800
  30,569
  6,142
  0
  0
  194,637
  38,477
  164,068
  32,402
  30,569
  6,075
  0
  0
  194,637
  38,813
  164,068
  32,561
  30,569
  6,252
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0

. file write tablecontent _n 

. 
. // tabulatevariable, variable(residence_type) min(1) max(8) missing 
. // file write tablecontent _n 
. 
. tabulatevariable, variable(urban) min(0) max(1) missing 
  194,637
  45,656
  164,068
  38,305
  30,569
  7,351
  0
  0
  194,637
  148,981
  164,068
  125,763
  30,569
  23,218
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0

. file write tablecontent _n 

. 
. /* HEALTH BEHAVIOURS */
. tabulatevariable, variable(bmicat) min(1) max(6) missing
  194,637
  4,372
  164,068
  3,692
  30,569
  680
  0
  0
  194,637
  56,981
  164,068
  48,051
  30,569
  8,930
  0
  0
  194,637
  61,870
  164,068
  52,667
  30,569
  9,203
  0
  0
  194,637
  35,315
  164,068
  29,652
  30,569
  5,663
  0
  0
  194,637
  14,999
  164,068
  12,372
  30,569
  2,627
  0
  0
  194,637
  7,727
  164,068
  6,156
  30,569
  1,571
  0
  0
  194,637
  13,373
  164,068
  11,478
  30,569
  1,895
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(obese4cat) min(1) max(4) missing
  194,637
  136,596
  164,068
  115,888
  30,569
  20,708
  0
  0
  194,637
  35,315
  164,068
  29,652
  30,569
  5,663
  0
  0
  194,637
  14,999
  164,068
  12,372
  30,569
  2,627
  0
  0
  194,637
  7,727
  164,068
  6,156
  30,569
  1,571
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(smoke) min(1) max(3) missing 
  194,637
  74,184
  164,068
  62,705
  30,569
  11,479
  0
  0
  194,637
  92,432
  164,068
  77,740
  30,569
  14,692
  0
  0
  194,637
  27,411
  164,068
  23,079
  30,569
  4,332
  0
  0
  194,637
  610
  164,068
  544
  30,569
  66
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(smoke_nomiss) min(1) max(3) missing 
  194,637
  74,794
  164,068
  63,249
  30,569
  11,545
  0
  0
  194,637
  92,432
  164,068
  77,740
  30,569
  14,692
  0
  0
  194,637
  27,411
  164,068
  23,079
  30,569
  4,332
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0

. file write tablecontent _n 

. 
. /* COMORBIDITY */
. tabulatevariable, variable(diabcat) min(1) max(4) missing
  194,637
  159,830
  164,068
  133,954
  30,569
  25,876
  0
  0
  194,637
  22,713
  164,068
  19,560
  30,569
  3,153
  0
  0
  194,637
  8,998
  164,068
  7,930
  30,569
  1,068
  0
  0
  194,637
  3,096
  164,068
  2,624
  30,569
  472
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(egfr_cat) min(1) max(3) missing 
  194,637
  133,371
  164,068
  109,606
  30,569
  23,765
  0
  0
  194,637
  24,528
  164,068
  21,153
  30,569
  3,375
  0
  0
  194,637
  1,944
  164,068
  1,698
  30,569
  246
  0
  0
  194,637
  34,794
  164,068
  31,611
  30,569
  3,183
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(egfr_cat_nomiss) min(1) max(3) missing 
  194,637
  168,165
  164,068
  141,217
  30,569
  26,948
  0
  0
  194,637
  24,528
  164,068
  21,153
  30,569
  3,375
  0
  0
  194,637
  1,944
  164,068
  1,698
  30,569
  246
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(chronic_cardiac_disease) min(0) max(1) missing 
  194,637
  164,028
  164,068
  137,776
  30,569
  26,252
  0
  0
  194,637
  30,609
  164,068
  26,292
  30,569
  4,317
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(chronic_liver_disease) min(0) max(1) missing 
  194,637
  191,919
  164,068
  161,841
  30,569
  30,078
  0
  0
  194,637
  2,718
  164,068
  2,227
  30,569
  491
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(resp_excl_asthma) min(0) max(1) missing 
  194,637
  167,957
  164,068
  141,909
  30,569
  26,048
  0
  0
  194,637
  26,680
  164,068
  22,159
  30,569
  4,521
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(neuro_conditions) min(0) max(1) missing 
  194,637
  181,919
  164,068
  153,065
  30,569
  28,854
  0
  0
  194,637
  12,718
  164,068
  11,003
  30,569
  1,715
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(hypertension) min(0) max(1) missing 
  194,637
  111,233
  164,068
  92,951
  30,569
  18,282
  0
  0
  194,637
  83,404
  164,068
  71,117
  30,569
  12,287
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(diabetes) min(0) max(1) missing 
  194,637
  159,830
  164,068
  133,954
  30,569
  25,876
  0
  0
  194,637
  34,807
  164,068
  30,114
  30,569
  4,693
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(cancer_ever) min(0) max(1) missing 
  194,637
  174,609
  164,068
  146,924
  30,569
  27,685
  0
  0
  194,637
  20,028
  164,068
  17,144
  30,569
  2,884
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(immunodef_any) min(0) max(1) missing 
  194,637
  191,668
  164,068
  161,669
  30,569
  29,999
  0
  0
  194,637
  2,969
  164,068
  2,399
  30,569
  570
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(flu_vaccine) min(0) max(1) missing 
  194,637
  72,342
  164,068
  62,956
  30,569
  9,386
  0
  0
  194,637
  122,295
  164,068
  101,112
  30,569
  21,183
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(pneumococcal_vaccine) min(0) max(1) missing 
  194,637
  161,546
  164,068
  137,731
  30,569
  23,815
  0
  0
  194,637
  33,091
  164,068
  26,337
  30,569
  6,754
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(gp_consult) min(0) max(1) missing 
  194,637
  9,076
  164,068
  8,496
  30,569
  580
  0
  0
  194,637
  185,561
  164,068
  155,572
  30,569
  29,989
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0

. file write tablecontent _n 

. 
. summarizevariable, variable(gp_consult_count)

. file write tablecontent _n 

. 
. file write tablecontent _n _n

. 
. ** TREATMENT VARIABLES (binary)
. foreach treat of varlist        hcq                     ///
>                                                         dmard_pc             
>    ///
>                                                         azith                
>    ///
>                                                         oral_prednisolone ///
>                                                         nsaids               
>    ///
>                                                         hcq_sa               
>    ///
>                                                         dmard_pc_sa     ///
>                                                         /********************
> ************************************   TO DO: ADD BIOLOGICS WHEN AVAILABLE***
> ***/ ///
>                                                 {               
  2. 
. local lab: variable label `treat'
  3. file write tablecontent ("`lab'") _n 
  4.         
. generaterow, variable(`treat') condition("==0")
  5. generaterow, variable(`treat') condition("==1")
  6. generaterow, variable(`treat') condition("==.")
  7. 
. file write tablecontent _n
  8. 
. }
  194,637
  164,068
  164,068
  164,068
  30,569
  0
  0
  0
  194,637
  30,569
  164,068
  0
  30,569
  30,569
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0
  194,637
  123,114
  164,068
  108,288
  30,569
  14,826
  0
  0
  194,637
  71,523
  164,068
  55,780
  30,569
  15,743
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0
  194,637
  193,689
  164,068
  163,317
  30,569
  30,372
  0
  0
  194,637
  948
  164,068
  751
  30,569
  197
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0
  194,637
  160,960
  164,068
  137,276
  30,569
  23,684
  0
  0
  194,637
  33,677
  164,068
  26,792
  30,569
  6,885
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0
  194,637
  161,281
  164,068
  137,382
  30,569
  23,899
  0
  0
  194,637
  33,356
  164,068
  26,686
  30,569
  6,670
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0
  194,637
  163,943
  164,068
  162,595
  30,569
  1,348
  0
  0
  194,637
  30,694
  164,068
  1,473
  30,569
  29,221
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0
  194,637
  123,401
  164,068
  108,430
  30,569
  14,971
  0
  0
  194,637
  71,236
  164,068
  55,638
  30,569
  15,598
  0
  0
  194,637
  0
  164,068
  0
  30,569
  0
  0
  0

. 
. 
. file close tablecontent

. 
. 
. 
. 
. 
. 
. 
. /* INVOKE PROGRAMS FOR TABLE 1 (RA only)=====================================
> ===*/ 
. 
. preserve 

. keep if population == 0
(26,763 observations deleted)

. 
. *Set up output file
. cap file close tablecontent

. file open tablecontent using $Tabfigdir/table1_ra.txt, write text replace

. 
. file write tablecontent ("Table 1: Demographic and Clinical Characteristics, 
> RA population") _n

. 
. * Exposure labelled columns
. 
. local lab0: label exposure 0

. local lab1: label exposure 1

. local labu: label exposure .u

. 
. 
. file write tablecontent _tab ("Total")                                       
>              _tab ///
>                                                          ("`lab0'")          
>                                          _tab ///
>                                                          ("`lab1'")          
>                                      _tab ///
>                                                          ("`labu'")          
>                                              _n 

. 
. * DEMOGRAPHICS (more than one level, potentially missing) 
. drop cons

. gen byte cons=1

. tabulatevariable, variable(cons) min(1) max(1) 
  167,874
  167,874
  144,151
  144,151
  23,723
  23,723
  0
  0

. file write tablecontent _n 

. 
. /* POPULATION */
. tabulatevariable, variable(population) min(0) max(1) 
  167,874
  167,874
  144,151
  144,151
  23,723
  23,723
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0

. file write tablecontent _n 

. 
. /* SOCIO-DEMOGRAPHICS */
. tabulatevariable, variable(agegroup) min(1) max(6) 
  167,874
  10,088
  144,151
  8,957
  23,723
  1,131
  0
  0
  167,874
  15,111
  144,151
  12,822
  23,723
  2,289
  0
  0
  167,874
  30,917
  144,151
  26,023
  23,723
  4,894
  0
  0
  167,874
  40,035
  144,151
  33,464
  23,723
  6,571
  0
  0
  167,874
  44,491
  144,151
  38,279
  23,723
  6,212
  0
  0
  167,874
  27,232
  144,151
  24,606
  23,723
  2,626
  0
  0

. file write tablecontent _n 

. 
. summarizevariable, variable(age)

. file write tablecontent _n 

. 
. tabulatevariable, variable(male) min(0) max(1) 
  167,874
  116,406
  144,151
  99,238
  23,723
  17,168
  0
  0
  167,874
  51,468
  144,151
  44,913
  23,723
  6,555
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(ethnicity) min(1) max(5) missing 
  167,874
  115,869
  144,151
  99,746
  23,723
  16,123
  0
  0
  167,874
  8,511
  144,151
  7,081
  23,723
  1,430
  0
  0
  167,874
  1,981
  144,151
  1,688
  23,723
  293
  0
  0
  167,874
  881
  144,151
  724
  23,723
  157
  0
  0
  167,874
  1,354
  144,151
  1,168
  23,723
  186
  0
  0
  167,874
  39,278
  144,151
  33,744
  23,723
  5,534
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(imd) min(1) max(5) missing
  167,874
  33,439
  144,151
  28,787
  23,723
  4,652
  0
  0
  167,874
  33,922
  144,151
  29,199
  23,723
  4,723
  0
  0
  167,874
  33,702
  144,151
  28,860
  23,723
  4,842
  0
  0
  167,874
  33,311
  144,151
  28,614
  23,723
  4,697
  0
  0
  167,874
  33,500
  144,151
  28,691
  23,723
  4,809
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0

. file write tablecontent _n 

. 
. // tabulatevariable, variable(residence_type) min(1) max(8) missing 
. // file write tablecontent _n 
. 
. tabulatevariable, variable(urban) min(0) max(1) missing 
  167,874
  39,577
  144,151
  33,829
  23,723
  5,748
  0
  0
  167,874
  128,297
  144,151
  110,322
  23,723
  17,975
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0

. file write tablecontent _n 

. 
. /* HEALTH BEHAVIOURS */
. tabulatevariable, variable(bmicat) min(1) max(6) missing
  167,874
  3,721
  144,151
  3,205
  23,723
  516
  0
  0
  167,874
  48,185
  144,151
  41,443
  23,723
  6,742
  0
  0
  167,874
  54,164
  144,151
  46,823
  23,723
  7,341
  0
  0
  167,874
  31,102
  144,151
  26,617
  23,723
  4,485
  0
  0
  167,874
  13,159
  144,151
  11,103
  23,723
  2,056
  0
  0
  167,874
  6,778
  144,151
  5,521
  23,723
  1,257
  0
  0
  167,874
  10,765
  144,151
  9,439
  23,723
  1,326
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(obese4cat) min(1) max(4) missing
  167,874
  116,835
  144,151
  100,910
  23,723
  15,925
  0
  0
  167,874
  31,102
  144,151
  26,617
  23,723
  4,485
  0
  0
  167,874
  13,159
  144,151
  11,103
  23,723
  2,056
  0
  0
  167,874
  6,778
  144,151
  5,521
  23,723
  1,257
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(smoke) min(1) max(3) missing 
  167,874
  63,068
  144,151
  54,640
  23,723
  8,428
  0
  0
  167,874
  81,304
  144,151
  69,376
  23,723
  11,928
  0
  0
  167,874
  23,023
  144,151
  19,696
  23,723
  3,327
  0
  0
  167,874
  479
  144,151
  439
  23,723
  40
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(smoke_nomiss) min(1) max(3) missing 
  167,874
  63,547
  144,151
  55,079
  23,723
  8,468
  0
  0
  167,874
  81,304
  144,151
  69,376
  23,723
  11,928
  0
  0
  167,874
  23,023
  144,151
  19,696
  23,723
  3,327
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0

. file write tablecontent _n 

. 
. /* COMORBIDITY */
. tabulatevariable, variable(diabcat) min(1) max(4) missing
  167,874
  136,690
  144,151
  116,885
  23,723
  19,805
  0
  0
  167,874
  20,294
  144,151
  17,659
  23,723
  2,635
  0
  0
  167,874
  8,171
  144,151
  7,261
  23,723
  910
  0
  0
  167,874
  2,719
  144,151
  2,346
  23,723
  373
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(egfr_cat) min(1) max(3) missing 
  167,874
  117,522
  144,151
  98,630
  23,723
  18,892
  0
  0
  167,874
  21,998
  144,151
  19,189
  23,723
  2,809
  0
  0
  167,874
  1,622
  144,151
  1,445
  23,723
  177
  0
  0
  167,874
  26,732
  144,151
  24,887
  23,723
  1,845
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(egfr_cat_nomiss) min(1) max(3) missing 
  167,874
  144,254
  144,151
  123,517
  23,723
  20,737
  0
  0
  167,874
  21,998
  144,151
  19,189
  23,723
  2,809
  0
  0
  167,874
  1,622
  144,151
  1,445
  23,723
  177
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(chronic_cardiac_disease) min(0) max(1) missing 
  167,874
  140,625
  144,151
  120,443
  23,723
  20,182
  0
  0
  167,874
  27,249
  144,151
  23,708
  23,723
  3,541
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(chronic_liver_disease) min(0) max(1) missing 
  167,874
  165,763
  144,151
  142,364
  23,723
  23,399
  0
  0
  167,874
  2,111
  144,151
  1,787
  23,723
  324
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(resp_excl_asthma) min(0) max(1) missing 
  167,874
  143,949
  144,151
  124,068
  23,723
  19,881
  0
  0
  167,874
  23,925
  144,151
  20,083
  23,723
  3,842
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(neuro_conditions) min(0) max(1) missing 
  167,874
  156,978
  144,151
  134,505
  23,723
  22,473
  0
  0
  167,874
  10,896
  144,151
  9,646
  23,723
  1,250
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(hypertension) min(0) max(1) missing 
  167,874
  94,011
  144,151
  80,196
  23,723
  13,815
  0
  0
  167,874
  73,863
  144,151
  63,955
  23,723
  9,908
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(diabetes) min(0) max(1) missing 
  167,874
  136,690
  144,151
  116,885
  23,723
  19,805
  0
  0
  167,874
  31,184
  144,151
  27,266
  23,723
  3,918
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(cancer_ever) min(0) max(1) missing 
  167,874
  150,271
  144,151
  128,913
  23,723
  21,358
  0
  0
  167,874
  17,603
  144,151
  15,238
  23,723
  2,365
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(immunodef_any) min(0) max(1) missing 
  167,874
  165,674
  144,151
  142,300
  23,723
  23,374
  0
  0
  167,874
  2,200
  144,151
  1,851
  23,723
  349
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(flu_vaccine) min(0) max(1) missing 
  167,874
  58,991
  144,151
  52,454
  23,723
  6,537
  0
  0
  167,874
  108,883
  144,151
  91,697
  23,723
  17,186
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(pneumococcal_vaccine) min(0) max(1) missing 
  167,874
  138,456
  144,151
  120,273
  23,723
  18,183
  0
  0
  167,874
  29,418
  144,151
  23,878
  23,723
  5,540
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(gp_consult) min(0) max(1) missing 
  167,874
  7,184
  144,151
  6,763
  23,723
  421
  0
  0
  167,874
  160,690
  144,151
  137,388
  23,723
  23,302
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0

. file write tablecontent _n 

. 
. summarizevariable, variable(gp_consult_count)

. file write tablecontent _n 

. 
. file write tablecontent _n _n

. 
. ** TREATMENT VARIABLES (binary)
. foreach treat of varlist        hcq                     ///
>                                                         dmard_pc             
>    ///
>                                                         azith                
>    ///
>                                                         oral_prednisolone ///
>                                                         nsaids               
>    ///
>                                                         hcq_sa               
>    ///
>                                                         dmard_pc_sa     ///
>                                                         /********************
> ************************************   TO DO: ADD BIOLOGICS WHEN AVAILABLE***
> ***/ ///
>                                                 {               
  2. 
. local lab: variable label `treat'
  3. file write tablecontent ("`lab'") _n 
  4.         
. generaterow, variable(`treat') condition("==0")
  5. generaterow, variable(`treat') condition("==1")
  6. generaterow, variable(`treat') condition("==.")
  7. 
. file write tablecontent _n
  8. 
. }
  167,874
  144,151
  144,151
  144,151
  23,723
  0
  0
  0
  167,874
  23,723
  144,151
  0
  23,723
  23,723
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0
  167,874
  99,384
  144,151
  89,750
  23,723
  9,634
  0
  0
  167,874
  68,490
  144,151
  54,401
  23,723
  14,089
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0
  167,874
  167,024
  144,151
  143,460
  23,723
  23,564
  0
  0
  167,874
  850
  144,151
  691
  23,723
  159
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0
  167,874
  139,016
  144,151
  120,183
  23,723
  18,833
  0
  0
  167,874
  28,858
  144,151
  23,968
  23,723
  4,890
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0
  167,874
  137,268
  144,151
  119,109
  23,723
  18,159
  0
  0
  167,874
  30,606
  144,151
  25,042
  23,723
  5,564
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0
  167,874
  144,188
  144,151
  143,128
  23,723
  1,060
  0
  0
  167,874
  23,686
  144,151
  1,023
  23,723
  22,663
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0
  167,874
  99,723
  144,151
  89,953
  23,723
  9,770
  0
  0
  167,874
  68,151
  144,151
  54,198
  23,723
  13,953
  0
  0
  167,874
  0
  144,151
  0
  23,723
  0
  0
  0

. 
. 
. file close tablecontent

. restore

. 
. 
. 
. 
. 
. /* INVOKE PROGRAMS FOR TABLE 1 (SLE only)====================================
> ====*/ 
. 
. preserve 

. keep if population == 1
(167,874 observations deleted)

. 
. *Set up output file
. cap file close tablecontent

. file open tablecontent using $Tabfigdir/table1_sle.txt, write text replace

. 
. file write tablecontent ("Table 1: Demographic and Clinical Characteristics, 
> SLE population") _n

. 
. * Exposure labelled columns
. 
. local lab0: label exposure 0

. local lab1: label exposure 1

. local labu: label exposure .u

. 
. 
. file write tablecontent _tab ("Total")                                       
>              _tab ///
>                                                          ("`lab0'")          
>                                          _tab ///
>                                                          ("`lab1'")          
>                                      _tab ///
>                                                          ("`labu'")          
>                                              _n 

. 
. * DEMOGRAPHICS (more than one level, potentially missing) 
. drop cons

. gen byte cons=1

. tabulatevariable, variable(cons) min(1) max(1) 
  26,763
  26,763
  19,917
  19,917
  6,846
  6,846
  0
  0

. file write tablecontent _n 

. 
. /* POPULATION */
. tabulatevariable, variable(population) min(0) max(1) 
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0
  26,763
  26,763
  19,917
  19,917
  6,846
  6,846
  0
  0

. file write tablecontent _n 

. 
. /* SOCIO-DEMOGRAPHICS */
. tabulatevariable, variable(agegroup) min(1) max(6) 
  26,763
  3,621
  19,917
  2,476
  6,846
  1,145
  0
  0
  26,763
  4,327
  19,917
  3,007
  6,846
  1,320
  0
  0
  26,763
  6,169
  19,917
  4,434
  6,846
  1,735
  0
  0
  26,763
  5,664
  19,917
  4,262
  6,846
  1,402
  0
  0
  26,763
  4,747
  19,917
  3,811
  6,846
  936
  0
  0
  26,763
  2,235
  19,917
  1,927
  6,846
  308
  0
  0

. file write tablecontent _n 

. 
. summarizevariable, variable(age)

. file write tablecontent _n 

. 
. tabulatevariable, variable(male) min(0) max(1) 
  26,763
  22,034
  19,917
  15,868
  6,846
  6,166
  0
  0
  26,763
  4,729
  19,917
  4,049
  6,846
  680
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(ethnicity) min(1) max(5) missing 
  26,763
  16,828
  19,917
  12,621
  6,846
  4,207
  0
  0
  26,763
  1,987
  19,917
  1,421
  6,846
  566
  0
  0
  26,763
  1,016
  19,917
  737
  6,846
  279
  0
  0
  26,763
  398
  19,917
  281
  6,846
  117
  0
  0
  26,763
  484
  19,917
  340
  6,846
  144
  0
  0
  26,763
  6,050
  19,917
  4,517
  6,846
  1,533
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(imd) min(1) max(5) missing
  26,763
  5,529
  19,917
  4,167
  6,846
  1,362
  0
  0
  26,763
  5,515
  19,917
  4,152
  6,846
  1,363
  0
  0
  26,763
  5,240
  19,917
  3,940
  6,846
  1,300
  0
  0
  26,763
  5,166
  19,917
  3,788
  6,846
  1,378
  0
  0
  26,763
  5,313
  19,917
  3,870
  6,846
  1,443
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0

. file write tablecontent _n 

. 
. // tabulatevariable, variable(residence_type) min(1) max(8) missing 
. // file write tablecontent _n 
. 
. tabulatevariable, variable(urban) min(0) max(1) missing 
  26,763
  6,079
  19,917
  4,476
  6,846
  1,603
  0
  0
  26,763
  20,684
  19,917
  15,441
  6,846
  5,243
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0

. file write tablecontent _n 

. 
. /* HEALTH BEHAVIOURS */
. tabulatevariable, variable(bmicat) min(1) max(6) missing
  26,763
  651
  19,917
  487
  6,846
  164
  0
  0
  26,763
  8,796
  19,917
  6,608
  6,846
  2,188
  0
  0
  26,763
  7,706
  19,917
  5,844
  6,846
  1,862
  0
  0
  26,763
  4,213
  19,917
  3,035
  6,846
  1,178
  0
  0
  26,763
  1,840
  19,917
  1,269
  6,846
  571
  0
  0
  26,763
  949
  19,917
  635
  6,846
  314
  0
  0
  26,763
  2,608
  19,917
  2,039
  6,846
  569
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(obese4cat) min(1) max(4) missing
  26,763
  19,761
  19,917
  14,978
  6,846
  4,783
  0
  0
  26,763
  4,213
  19,917
  3,035
  6,846
  1,178
  0
  0
  26,763
  1,840
  19,917
  1,269
  6,846
  571
  0
  0
  26,763
  949
  19,917
  635
  6,846
  314
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(smoke) min(1) max(3) missing 
  26,763
  11,116
  19,917
  8,065
  6,846
  3,051
  0
  0
  26,763
  11,128
  19,917
  8,364
  6,846
  2,764
  0
  0
  26,763
  4,388
  19,917
  3,383
  6,846
  1,005
  0
  0
  26,763
  131
  19,917
  105
  6,846
  26
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(smoke_nomiss) min(1) max(3) missing 
  26,763
  11,247
  19,917
  8,170
  6,846
  3,077
  0
  0
  26,763
  11,128
  19,917
  8,364
  6,846
  2,764
  0
  0
  26,763
  4,388
  19,917
  3,383
  6,846
  1,005
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0

. file write tablecontent _n 

. 
. /* COMORBIDITY */
. tabulatevariable, variable(diabcat) min(1) max(4) missing
  26,763
  23,140
  19,917
  17,069
  6,846
  6,071
  0
  0
  26,763
  2,419
  19,917
  1,901
  6,846
  518
  0
  0
  26,763
  827
  19,917
  669
  6,846
  158
  0
  0
  26,763
  377
  19,917
  278
  6,846
  99
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(egfr_cat) min(1) max(3) missing 
  26,763
  15,849
  19,917
  10,976
  6,846
  4,873
  0
  0
  26,763
  2,530
  19,917
  1,964
  6,846
  566
  0
  0
  26,763
  322
  19,917
  253
  6,846
  69
  0
  0
  26,763
  8,062
  19,917
  6,724
  6,846
  1,338
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(egfr_cat_nomiss) min(1) max(3) missing 
  26,763
  23,911
  19,917
  17,700
  6,846
  6,211
  0
  0
  26,763
  2,530
  19,917
  1,964
  6,846
  566
  0
  0
  26,763
  322
  19,917
  253
  6,846
  69
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(chronic_cardiac_disease) min(0) max(1) missing 
  26,763
  23,403
  19,917
  17,333
  6,846
  6,070
  0
  0
  26,763
  3,360
  19,917
  2,584
  6,846
  776
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(chronic_liver_disease) min(0) max(1) missing 
  26,763
  26,156
  19,917
  19,477
  6,846
  6,679
  0
  0
  26,763
  607
  19,917
  440
  6,846
  167
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(resp_excl_asthma) min(0) max(1) missing 
  26,763
  24,008
  19,917
  17,841
  6,846
  6,167
  0
  0
  26,763
  2,755
  19,917
  2,076
  6,846
  679
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(neuro_conditions) min(0) max(1) missing 
  26,763
  24,941
  19,917
  18,560
  6,846
  6,381
  0
  0
  26,763
  1,822
  19,917
  1,357
  6,846
  465
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(hypertension) min(0) max(1) missing 
  26,763
  17,222
  19,917
  12,755
  6,846
  4,467
  0
  0
  26,763
  9,541
  19,917
  7,162
  6,846
  2,379
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(diabetes) min(0) max(1) missing 
  26,763
  23,140
  19,917
  17,069
  6,846
  6,071
  0
  0
  26,763
  3,623
  19,917
  2,848
  6,846
  775
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(cancer_ever) min(0) max(1) missing 
  26,763
  24,338
  19,917
  18,011
  6,846
  6,327
  0
  0
  26,763
  2,425
  19,917
  1,906
  6,846
  519
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(immunodef_any) min(0) max(1) missing 
  26,763
  25,994
  19,917
  19,369
  6,846
  6,625
  0
  0
  26,763
  769
  19,917
  548
  6,846
  221
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(flu_vaccine) min(0) max(1) missing 
  26,763
  13,351
  19,917
  10,502
  6,846
  2,849
  0
  0
  26,763
  13,412
  19,917
  9,415
  6,846
  3,997
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(pneumococcal_vaccine) min(0) max(1) missing 
  26,763
  23,090
  19,917
  17,458
  6,846
  5,632
  0
  0
  26,763
  3,673
  19,917
  2,459
  6,846
  1,214
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0

. file write tablecontent _n 

. 
. tabulatevariable, variable(gp_consult) min(0) max(1) missing 
  26,763
  1,892
  19,917
  1,733
  6,846
  159
  0
  0
  26,763
  24,871
  19,917
  18,184
  6,846
  6,687
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0

. file write tablecontent _n 

. 
. summarizevariable, variable(gp_consult_count)

. file write tablecontent _n 

. 
. file write tablecontent _n _n

. 
. ** TREATMENT VARIABLES (binary)
. foreach treat of varlist        hcq                     ///
>                                                         dmard_pc             
>    ///
>                                                         azith                
>    ///
>                                                         oral_prednisolone ///
>                                                         nsaids               
>    ///
>                                                         hcq_sa               
>    ///
>                                                         dmard_pc_sa     ///
>                                                         /********************
> ************************************   TO DO: ADD BIOLOGICS WHEN AVAILABLE***
> ***/ ///
>                                                 {               
  2. 
. local lab: variable label `treat'
  3. file write tablecontent ("`lab'") _n 
  4.         
. generaterow, variable(`treat') condition("==0")
  5. generaterow, variable(`treat') condition("==1")
  6. generaterow, variable(`treat') condition("==.")
  7. 
. file write tablecontent _n
  8. 
. }
  26,763
  19,917
  19,917
  19,917
  6,846
  0
  0
  0
  26,763
  6,846
  19,917
  0
  6,846
  6,846
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0
  26,763
  23,730
  19,917
  18,538
  6,846
  5,192
  0
  0
  26,763
  3,033
  19,917
  1,379
  6,846
  1,654
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0
  26,763
  26,665
  19,917
  19,857
  6,846
  6,808
  0
  0
  26,763
  98
  19,917
  60
  6,846
  38
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0
  26,763
  21,944
  19,917
  17,093
  6,846
  4,851
  0
  0
  26,763
  4,819
  19,917
  2,824
  6,846
  1,995
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0
  26,763
  24,013
  19,917
  18,273
  6,846
  5,740
  0
  0
  26,763
  2,750
  19,917
  1,644
  6,846
  1,106
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0
  26,763
  19,755
  19,917
  19,467
  6,846
  288
  0
  0
  26,763
  7,008
  19,917
  450
  6,846
  6,558
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0
  26,763
  23,678
  19,917
  18,477
  6,846
  5,201
  0
  0
  26,763
  3,085
  19,917
  1,440
  6,846
  1,645
  0
  0
  26,763
  0
  19,917
  0
  6,846
  0
  0
  0

. 
. 
. file close tablecontent

. restore

. 
. * Close log file 
. log close
      name:  <unnamed>
       log:  E:\analyses\hydroxychloroquine-research/output/log\04_an_descripti
> ve_table.log
  log type:  text
 closed on:  19 Aug 2020, 16:54:15
-------------------------------------------------------------------------------
