-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  E:\analyses\hydroxychloroquine-research/output/log\03_an_checks.lo
> g
  log type:  text
 opened on:  21 Jul 2020, 14:32:56

. 
. * Open Stata dataset
. use $Tempdir\analysis_dataset, clear

. 
. 
. *Duplicate patient check
. datacheck _n==1, by(patient_id) nol

. 
. /* EXPECTED VALUES===========================================================
> =*/ 
. 
. * Age
. datacheck age<., nol

. datacheck inlist(agegroup, 1, 2, 3, 4, 5, 6), nol

. datacheck inlist(age70, 0, 1), nol

. 
. * Sex
. datacheck inlist(male, 0, 1), nol

. 
. * BMI 
. datacheck inlist(obese4cat, 1, 2, 3, 4), nol

. datacheck inlist(bmicat, 1, 2, 3, 4, 5, 6, .u), nol

. 
. * IMD
. datacheck inlist(imd, 1, 2, 3, 4, 5), nol

. 
. * Residence type
. datacheck inlist(residence_type, 1, 2, 3, 4, 5, 6, 7, 8, .u), nol

. 
. * Ethnicity
. datacheck inlist(ethnicity, 1, 2, 3, 4, 5, .u), nol

. 
. * Smoking
. datacheck inlist(smoke, 1, 2, 3, .u), nol

. datacheck inlist(smoke_nomiss, 1, 2, 3), nol 

. 
. 
. 
. * Check date ranges for all treatment variables   
. foreach var of varlist  hcq                                     ///
>                                                 dmard_pc                ///
>                                                 oral_prednisolone       ///
>                                                 nsaids                       
>    ///
>                                                 azith                        
>    ///
>          {
  2.                                                 
.         tab `var', missing                                      
  3.         summ `var'_date, format
  4. 
. }

        HCQ |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    163,774       84.30       84.30
          1 |     30,512       15.70      100.00
------------+-----------------------------------
      Total |    194,286      100.00

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
    hcq_date |     33,825   22jan2020     36.9013  15sep2019  15feb2020

 DMARD (PC) |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    122,914       63.26       63.26
          1 |     71,372       36.74      100.00
------------+-----------------------------------
      Total |    194,286      100.00

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
dmard_pc_d~e |     75,622   30jan2020    31.47491  15sep2019  15feb2020

        OCS |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    160,685       82.71       82.71
          1 |     33,601       17.29      100.00
------------+-----------------------------------
      Total |    194,286      100.00

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
oral_pred~te |     33,601   11jan2020    44.87656  15sep2019  15feb2020

     NSAIDs |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    161,015       82.88       82.88
          1 |     33,271       17.12      100.00
------------+-----------------------------------
      Total |    194,286      100.00

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
 nsaids_date |     33,271   08jan2020      47.038  15sep2019  15feb2020

Azithromyci |
          n |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    193,339       99.51       99.51
          1 |        947        0.49      100.00
------------+-----------------------------------
      Total |    194,286      100.00

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
  azith_date |        947   14feb2020    4.459601  15jan2020  15feb2020

. 
. * Check date ranges for all comorbidities 
. foreach var of varlist  chronic_cardiac_disease_date    ///
>                                                 chronic_liver_disease_date   
>            ///
>                                                 egfr_date                    
>                    ///
>                                                 hypertension_date            
>                    ///
>                                                 diabetes_date                
>                    ///
>                                                 cancer_ever_date             
>                    ///
>                                                 perm_immunodef_date          
>                    ///
>                                                 temp_immunodef_date          
>                    ///
>                                                 hba1c_mmol_per_mol_date      
>            ///
>                                                 hba1c_percentage_date        
>            ///
>                                                 resp_excl_asthma_date        
>            ///     
>                                                 current_asthma_date          
>                    ///
>                                                 neuro_conditions_date        
>            ///
>                                                 rheumatoid_date              
>                    ///
>                                                 sle_date        { 
  2.                                                 
.         summ `var', format
  3. 
. }

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_c~te |     30,548   24jul2006    6946.773  15dec1840  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_l~te |      2,709   28feb2008      6542.9  15jan1900  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   egfr_date |    152,919   21nov2019    93.16732  15feb2019  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
hypertensi~e |     83,238   28jan2003    7513.563  15jan1850  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
diabetes_d~e |     34,736   22nov2007    6681.975  15sep1899  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
cancer_eve~e |     19,982   16nov2008    4877.176  15dec1899  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
perm_immun~e |      2,084   02jul2006    6366.282  15jan1900  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
temp_immun~e |        897   16oct2019    100.2452  15mar2019  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
hba1c_mmol~e |    152,129   24nov2018     545.693  15feb1995  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
hba1c_perc~e |     69,972   27feb2016    1550.055  15jan1900  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
resp_excl_~e |     26,624   10feb2008    7019.119  15jan1800  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
current_as~e |     38,552   02sep1994    9401.073  15jan1800  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
neuro_cond~e |     12,696   22jan2008    6494.232  15dec1899  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
rheumatoid~e |    168,653   13jan2005    7259.417  15jan1800  15aug2019

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
    sle_date |     28,285   29jun2001    7486.303  15dec1899  15aug2019

. 
. 
. 
. * Outcome dates
. summ  died_date_onscovid died_date_onsnoncovid first_pos_test_sgss first_pos_
> test_primcare, format

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
died_~scovid |        539   24apr2020    20.53657  15mar2020  01jul2020
died_~ncovid |      1,817   27apr2020     34.9437  02mar2020  06jul2020
first_pos_~s |      1,338   23apr2020    24.87733  03mar2020  08jul2020
first_pos_~e |      1,360   23apr2020    100.9444  07feb2014  14jul2020

. 
. * Censoring dates
. summ  onscoviddeathcensor_date hcq_first_after_date, format

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
onscovidde~e |    194,286   29jun2020           0  29jun2020  29jun2020
hcq_first_~e |      2,947   16apr2020    36.22541  02mar2020  16jul2020

. 
. * Last dates
. summ  stime_onscoviddeath stime_onsnoncoviddeath stime_firstpos_sgss stime_fi
> rstpos_primcare,   format

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
stime_onsc~h |    194,286   27jun2020    12.64545  02mar2020  29jun2020
stime_onsn~h |    194,286   27jun2020    12.64545  02mar2020  29jun2020
stime_firs~s |    194,286   05jul2020    14.97697  02mar2020  08jul2020
stime_firs~e |    194,286   11jul2020    18.12439  07feb2014  14jul2020

. 
. 
. 
. 
. /* FREQUENCIES ==============================================================
> =*/ 
. * Check frequency of all variables in fully adjusted model 
. foreach comorb in $varlist { 
  2. 
.         local comorb: subinstr local comorb "i." ""
  3.         tab `comorb', m
  4.         
. }

        HCQ |
   Exposure |      Freq.     Percent        Cum.
------------+-----------------------------------
     No HCQ |    163,774       84.30       84.30
        HCQ |     30,512       15.70      100.00
------------+-----------------------------------
      Total |    194,286      100.00

       Male |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    138,203       71.13       71.13
          1 |     56,083       28.87      100.00
------------+-----------------------------------
      Total |    194,286      100.00

Grouped age |      Freq.     Percent        Cum.
------------+-----------------------------------
     18-<40 |     13,686        7.04        7.04
     40-<50 |     19,411        9.99       17.04
     50-<60 |     37,019       19.05       36.09
     60-<70 |     45,635       23.49       59.58
     70-<80 |     49,115       25.28       84.86
        80+ |     29,420       15.14      100.00
------------+-----------------------------------
      Total |    194,286      100.00

 DMARD (PC) |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    122,914       63.26       63.26
          1 |     71,372       36.74      100.00
------------+-----------------------------------
      Total |    194,286      100.00

        OCS |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    160,685       82.71       82.71
          1 |     33,601       17.29      100.00
------------+-----------------------------------
      Total |    194,286      100.00

    Chronic |
    cardiac |
    disease |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    163,738       84.28       84.28
          1 |     30,548       15.72      100.00
------------+-----------------------------------
      Total |    194,286      100.00

Respiratory |
    disease |
      (excl |
    asthma) |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    167,662       86.30       86.30
          1 |     26,624       13.70      100.00
------------+-----------------------------------
      Total |    194,286      100.00

  Calculated |
        eGFR |
(missing set |
    to norm) |      Freq.     Percent        Cum.
-------------+-----------------------------------
>=60/missing |    168,591       86.77       86.77
       30-59 |     23,808       12.25       99.03
         <30 |      1,887        0.97      100.00
-------------+-----------------------------------
       Total |    194,286      100.00

    Chronic |
      liver |
    disease |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    191,577       98.61       98.61
          1 |      2,709        1.39      100.00
------------+-----------------------------------
      Total |    194,286      100.00

 Evidence of obesity |
      (4 categories) |      Freq.     Percent        Cum.
---------------------+-----------------------------------
No record of obesity |    136,377       70.19       70.19
   Obese I (30-34.9) |     35,177       18.11       88.30
  Obese II (35-39.9) |     15,035        7.74       96.04
     Obese III (40+) |      7,697        3.96      100.00
---------------------+-----------------------------------
               Total |    194,286      100.00

  Diagnosed |
hypertensio |
          n |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    111,048       57.16       57.16
          1 |     83,238       42.84      100.00
------------+-----------------------------------
      Total |    194,286      100.00

     Cancer |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    174,304       89.72       89.72
          1 |     19,982       10.28      100.00
------------+-----------------------------------
      Total |    194,286      100.00

Neurologica |
          l |
 conditions |
(stroke+dem |
entia+other |
          ) |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    181,590       93.47       93.47
          1 |     12,696        6.53      100.00
------------+-----------------------------------
      Total |    194,286      100.00

Flu vaccine |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     72,230       37.18       37.18
          1 |    122,056       62.82      100.00
------------+-----------------------------------
      Total |    194,286      100.00

. 
. 
. 
. /* LOGICAL RELATIONSHIPS=====================================================
> =*/ 
. 
. * BMI
. bysort bmicat: summ bmi

-------------------------------------------------------------------------------
-> bmicat = Underweight (<18.5)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |      4,467    17.27799    .9017903         15       18.4

-------------------------------------------------------------------------------
-> bmicat = Normal (18.5-24.9)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |     57,201     22.3912     1.71449       18.5       24.9

-------------------------------------------------------------------------------
-> bmicat = Overweight (25-29.9)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |     61,730    27.31452    1.414385         25       29.9

-------------------------------------------------------------------------------
-> bmicat = Obese I (30-34.9)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |     35,177    32.13572    1.426556         30       34.9

-------------------------------------------------------------------------------
-> bmicat = Obese II (35-39.9)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |     15,035    37.08361    1.410893         35       39.9

-------------------------------------------------------------------------------
-> bmicat = Obese III (40+)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |      7,697    43.38967    2.645396         40         50

-------------------------------------------------------------------------------
-> bmicat = Unknown (.u)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |          0


. tab bmicat obese4cat, m

                     |     Evidence of obesity (4 categories)
         Grouped BMI | No record  Obese I (  Obese II   Obese III |     Total
---------------------+--------------------------------------------+----------
 Underweight (<18.5) |     4,467          0          0          0 |     4,467 
  Normal (18.5-24.9) |    57,201          0          0          0 |    57,201 
Overweight (25-29.9) |    61,730          0          0          0 |    61,730 
   Obese I (30-34.9) |         0     35,177          0          0 |    35,177 
  Obese II (35-39.9) |         0          0     15,035          0 |    15,035 
     Obese III (40+) |         0          0          0      7,697 |     7,697 
        Unknown (.u) |    12,979          0          0          0 |    12,979 
---------------------+--------------------------------------------+----------
               Total |   136,377     35,177     15,035      7,697 |   194,286 

. 
. * Age
. bysort agegroup: summ age

-------------------------------------------------------------------------------
-> agegroup = 18-<40

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |     13,686    32.21211    5.466898         18         39

-------------------------------------------------------------------------------
-> agegroup = 40-<50

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |     19,411    45.18376    2.863038         40         49

-------------------------------------------------------------------------------
-> agegroup = 50-<60

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |     37,019    54.86194    2.826054         50         59

-------------------------------------------------------------------------------
-> agegroup = 60-<70

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |     45,635    64.60526    2.867802         60         69

-------------------------------------------------------------------------------
-> agegroup = 70-<80

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |     49,115    74.16189    2.774036         70         79

-------------------------------------------------------------------------------
-> agegroup = 80+

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |     29,420    84.83192    4.154556         80        110


. tab agegroup age70, m

   Grouped |  70 years and older
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<40 |    13,686          0 |    13,686 
    40-<50 |    19,411          0 |    19,411 
    50-<60 |    37,019          0 |    37,019 
    60-<70 |    45,635          0 |    45,635 
    70-<80 |         0     49,115 |    49,115 
       80+ |         0     29,420 |    29,420 
-----------+----------------------+----------
     Total |   115,751     78,535 |   194,286 

. 
. * Smoking
. tab smoke smoke_nomiss, m

             |  Smoking status (missing set to
     Smoking |               non)
      status |     Never     Former    Current |     Total
-------------+---------------------------------+----------
       Never |    74,060          0          0 |    74,060 
      Former |         0     92,247          0 |    92,247 
     Current |         0          0     27,369 |    27,369 
Unknown (.u) |       610          0          0 |       610 
-------------+---------------------------------+----------
       Total |    74,670     92,247     27,369 |   194,286 

. 
. * Diabetes
. tab diabcat diabetes, m

                      |       Diabetes
    Diabetes Severity |         0          1 |     Total
----------------------+----------------------+----------
          No diabetes |   159,550          0 |   159,550 
  Controlled diabetes |         0     24,808 |    24,808 
Uncontrolled diabetes |         0      9,364 |     9,364 
Diabetes, no hba1c me |         0        564 |       564 
----------------------+----------------------+----------
                Total |   159,550     34,736 |   194,286 

. 
. * eGFR
. tab egfr_cat_nomiss egfr_cat, m

  Calculated |
        eGFR |
(missing set |               Calculated eGFR
    to norm) |      >=60      30-59        <30  Unknown ( |     Total
-------------+--------------------------------------------+----------
>=60/missing |   127,224          0          0     41,367 |   168,591 
       30-59 |         0     23,808          0          0 |    23,808 
         <30 |         0          0      1,887          0 |     1,887 
-------------+--------------------------------------------+----------
       Total |   127,224     23,808      1,887     41,367 |   194,286 

. 
. * urban residence
. *tab residence_type urban, m
. 
. 
. 
. 
. /* EXPECTED RELATIONSHIPS====================================================
> =*/ 
. 
. /*  Relationships between demographic/lifestyle variables  */
. 
. // tab agegroup bmicat,         row 
. // tab agegroup smoke,  row  
. // tab agegroup ethnicity, row 
. // tab agegroup imd,            row 
. //
. // tab bmicat smoke,             row   
. // tab bmicat ethnicity,         row 
. // tab bmicat imd,               row 
. // tab bmicat hypertension, row 
. //                            
. // tab smoke ethnicity,         row 
. // tab smoke imd,                       row 
. // tab smoke hypertension, row 
. //                            
. // tab ethnicity imd,           row 
. //
. // * Relationships with age
. // foreach var in $varlist                              {
. //      local var: subinstr local var "i." ""
. //      tab agegroup `var', row 
. //  }
. //
. //
. //  * Relationships with sex
. // foreach var in $varlist                                      {
. //      local var: subinstr local var "i." ""                                
>            
. //      tab male `var', row 
. // }
. //
. //  * Relationships with smoking
. // foreach var in $varlist                              {
. //      local var: subinstr local var "i." ""   
. //      tab smoke `var', row 
. // }
. 
. 
. 
. /* CROSS TABS================================================================
> =*/ 
. /* Treatment variables */ 
. foreach var of varlist  hcq                                     ///
>                                                 dmard_pc                     
>    ///
>                                                 azith                   ///
>                                                 oral_prednisolone       ///
>                                                 {
  2.                                                 
.         tab exposure `var', row col missing
  3. 
. }

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

       HCQ |          HCQ
  Exposure |         0          1 |     Total
-----------+----------------------+----------
    No HCQ |   163,774          0 |   163,774 
           |    100.00       0.00 |    100.00 
           |    100.00       0.00 |     84.30 
-----------+----------------------+----------
       HCQ |         0     30,512 |    30,512 
           |      0.00     100.00 |    100.00 
           |      0.00     100.00 |     15.70 
-----------+----------------------+----------
     Total |   163,774     30,512 |   194,286 
           |     84.30      15.70 |    100.00 
           |    100.00     100.00 |    100.00 

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

       HCQ |      DMARD (PC)
  Exposure |         0          1 |     Total
-----------+----------------------+----------
    No HCQ |   108,114     55,660 |   163,774 
           |     66.01      33.99 |    100.00 
           |     87.96      77.99 |     84.30 
-----------+----------------------+----------
       HCQ |    14,800     15,712 |    30,512 
           |     48.51      51.49 |    100.00 
           |     12.04      22.01 |     15.70 
-----------+----------------------+----------
     Total |   122,914     71,372 |   194,286 
           |     63.26      36.74 |    100.00 
           |    100.00     100.00 |    100.00 

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

       HCQ |     Azithromycin
  Exposure |         0          1 |     Total
-----------+----------------------+----------
    No HCQ |   163,024        750 |   163,774 
           |     99.54       0.46 |    100.00 
           |     84.32      79.20 |     84.30 
-----------+----------------------+----------
       HCQ |    30,315        197 |    30,512 
           |     99.35       0.65 |    100.00 
           |     15.68      20.80 |     15.70 
-----------+----------------------+----------
     Total |   193,339        947 |   194,286 
           |     99.51       0.49 |    100.00 
           |    100.00     100.00 |    100.00 

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

       HCQ |          OCS
  Exposure |         0          1 |     Total
-----------+----------------------+----------
    No HCQ |   137,042     26,732 |   163,774 
           |     83.68      16.32 |    100.00 
           |     85.29      79.56 |     84.30 
-----------+----------------------+----------
       HCQ |    23,643      6,869 |    30,512 
           |     77.49      22.51 |    100.00 
           |     14.71      20.44 |     15.70 
-----------+----------------------+----------
     Total |   160,685     33,601 |   194,286 
           |     82.71      17.29 |    100.00 
           |    100.00     100.00 |    100.00 

. 
. /* AGE/SEX DISTRIBUTION BY HCQ USE      =====================================
> =*/
. tab agegroup sex if hcq == 1,m

   Grouped |          Sex
       age |         F          M |     Total
-----------+----------------------+----------
    18-<40 |     2,010        265 |     2,275 
    40-<50 |     3,096        506 |     3,602 
    50-<60 |     5,288      1,328 |     6,616 
    60-<70 |     5,853      2,113 |     7,966 
    70-<80 |     4,999      2,128 |     7,127 
       80+ |     2,055        871 |     2,926 
-----------+----------------------+----------
     Total |    23,301      7,211 |    30,512 

. tab agegroup sex if hcq == 0,m

   Grouped |          Sex
       age |         F          M |     Total
-----------+----------------------+----------
    18-<40 |     8,489      2,922 |    11,411 
    40-<50 |    11,558      4,251 |    15,809 
    50-<60 |    21,516      8,887 |    30,403 
    60-<70 |    26,146     11,523 |    37,669 
    70-<80 |    28,463     13,525 |    41,988 
       80+ |    18,730      7,764 |    26,494 
-----------+----------------------+----------
     Total |   114,902     48,872 |   163,774 

. 
. 
. /* SENSE CHECK POPULATIONS===================================================
> =*/
. tab rheumatoid sle, row col

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

           |          SLE
        RA |         0          1 |     Total
-----------+----------------------+----------
         0 |         0     25,633 |    25,633 
           |      0.00     100.00 |    100.00 
           |      0.00      90.62 |     13.19 
-----------+----------------------+----------
         1 |   166,001      2,652 |   168,653 
           |     98.43       1.57 |    100.00 
           |    100.00       9.38 |     86.81 
-----------+----------------------+----------
     Total |   166,001     28,285 |   194,286 
           |     85.44      14.56 |    100.00 
           |    100.00     100.00 |    100.00 

. tab population, m

 Population |      Freq.     Percent        Cum.
------------+-----------------------------------
         RA |    167,554       86.24       86.24
        SLE |     26,732       13.76      100.00
------------+-----------------------------------
      Total |    194,286      100.00

. tab population rheumatoid, m

           |          RA
Population |         0          1 |     Total
-----------+----------------------+----------
        RA |         0    167,554 |   167,554 
       SLE |    25,633      1,099 |    26,732 
-----------+----------------------+----------
     Total |    25,633    168,653 |   194,286 

. tab population sle, m

           |          SLE
Population |         0          1 |     Total
-----------+----------------------+----------
        RA |   166,001      1,553 |   167,554 
       SLE |         0     26,732 |    26,732 
-----------+----------------------+----------
     Total |   166,001     28,285 |   194,286 

. 
. 
. /* SENSE CHECK OUTCOMES======================================================
> =*/
. tab firstpos_sgss firstpos_primcare, row col

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

Failure/ce |
   nsoring |
 indicator |
       for |   Failure/censoring
  outcome: |     indicator for
      SGSS | outcome: primary care
  positive |     positive test
      test |         0          1 |     Total
-----------+----------------------+----------
         0 |   192,329        619 |   192,948 
           |     99.68       0.32 |    100.00 
           |     99.69      45.51 |     99.31 
-----------+----------------------+----------
         1 |       597        741 |     1,338 
           |     44.62      55.38 |    100.00 
           |      0.31      54.49 |      0.69 
-----------+----------------------+----------
     Total |   192,926      1,360 |   194,286 
           |     99.30       0.70 |    100.00 
           |    100.00     100.00 |    100.00 

. tab onscoviddeath onsnoncoviddeath, row col

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

Failure/ce |
   nsoring |
 indicator |   Failure/censoring
       for |     indicator for
  outcome: |     outcome: ONS
 ONS covid |    non-covid death
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   191,959      1,789 |   193,748 
           |     99.08       0.92 |    100.00 
           |     99.72     100.00 |     99.72 
-----------+----------------------+----------
         1 |       538          0 |       538 
           |    100.00       0.00 |    100.00 
           |      0.28       0.00 |      0.28 
-----------+----------------------+----------
     Total |   192,497      1,789 |   194,286 
           |     99.08       0.92 |    100.00 
           |    100.00     100.00 |    100.00 

. 
. /* ENSURE ENOUGH DEATHS IN EACH CATEGORY INCLUDED IN FULLY ADJUSTED MODEL ===
> =*/
. foreach var in $varlist                                 {
  2.         local var: subinstr local var "i." ""   
  3.         tab onscoviddeath `var', row 
  4. }

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
 ONS covid |     HCQ Exposure
     death |    No HCQ        HCQ |     Total
-----------+----------------------+----------
         0 |   163,304     30,444 |   193,748 
           |     84.29      15.71 |    100.00 
-----------+----------------------+----------
         1 |       470         68 |       538 
           |     87.36      12.64 |    100.00 
-----------+----------------------+----------
     Total |   163,774     30,512 |   194,286 
           |     84.30      15.70 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
 ONS covid |         Male
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   137,868     55,880 |   193,748 
           |     71.16      28.84 |    100.00 
-----------+----------------------+----------
         1 |       335        203 |       538 
           |     62.27      37.73 |    100.00 
-----------+----------------------+----------
     Total |   138,203     56,083 |   194,286 
           |     71.13      28.87 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
 ONS covid |                      Grouped age
     death |    18-<40     40-<50     50-<60     60-<70     70-<80 |     Total
-----------+-------------------------------------------------------+----------
         0 |    13,686     19,404     37,002     45,586     48,945 |   193,748 
           |      7.06      10.02      19.10      23.53      25.26 |    100.00 
-----------+-------------------------------------------------------+----------
         1 |         0          7         17         49        170 |       538 
           |      0.00       1.30       3.16       9.11      31.60 |    100.00 
-----------+-------------------------------------------------------+----------
     Total |    13,686     19,411     37,019     45,635     49,115 |   194,286 
           |      7.04       9.99      19.05      23.49      25.28 |    100.00 


Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |  Grouped
 ONS covid |    age
     death |       80+ |     Total
-----------+-----------+----------
         0 |    29,125 |   193,748 
           |     15.03 |    100.00 
-----------+-----------+----------
         1 |       295 |       538 
           |     54.83 |    100.00 
-----------+-----------+----------
     Total |    29,420 |   194,286 
           |     15.14 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
 ONS covid |      DMARD (PC)
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   122,567     71,181 |   193,748 
           |     63.26      36.74 |    100.00 
-----------+----------------------+----------
         1 |       347        191 |       538 
           |     64.50      35.50 |    100.00 
-----------+----------------------+----------
     Total |   122,914     71,372 |   194,286 
           |     63.26      36.74 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
 ONS covid |          OCS
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   160,358     33,390 |   193,748 
           |     82.77      17.23 |    100.00 
-----------+----------------------+----------
         1 |       327        211 |       538 
           |     60.78      39.22 |    100.00 
-----------+----------------------+----------
     Total |   160,685     33,601 |   194,286 
           |     82.71      17.29 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |    Chronic cardiac
 ONS covid |        disease
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   163,418     30,330 |   193,748 
           |     84.35      15.65 |    100.00 
-----------+----------------------+----------
         1 |       320        218 |       538 
           |     59.48      40.52 |    100.00 
-----------+----------------------+----------
     Total |   163,738     30,548 |   194,286 
           |     84.28      15.72 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |  Respiratory disease
 ONS covid |     (excl asthma)
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   167,291     26,457 |   193,748 
           |     86.34      13.66 |    100.00 
-----------+----------------------+----------
         1 |       371        167 |       538 
           |     68.96      31.04 |    100.00 
-----------+----------------------+----------
     Total |   167,662     26,624 |   194,286 
           |     86.30      13.70 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: | Calculated eGFR (missing set to
 ONS covid |              norm)
     death | >=60/miss      30-59        <30 |     Total
-----------+---------------------------------+----------
         0 |   168,246     23,645      1,857 |   193,748 
           |     86.84      12.20       0.96 |    100.00 
-----------+---------------------------------+----------
         1 |       345        163         30 |       538 
           |     64.13      30.30       5.58 |    100.00 
-----------+---------------------------------+----------
     Total |   168,591     23,808      1,887 |   194,286 
           |     86.77      12.25       0.97 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
 ONS covid | Chronic liver disease
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   191,049      2,699 |   193,748 
           |     98.61       1.39 |    100.00 
-----------+----------------------+----------
         1 |       528         10 |       538 
           |     98.14       1.86 |    100.00 
-----------+----------------------+----------
     Total |   191,577      2,709 |   194,286 
           |     98.61       1.39 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
 ONS covid |     Evidence of obesity (4 categories)
     death | No record  Obese I (  Obese II   Obese III |     Total
-----------+--------------------------------------------+----------
         0 |   135,990     35,082     14,996      7,680 |   193,748 
           |     70.19      18.11       7.74       3.96 |    100.00 
-----------+--------------------------------------------+----------
         1 |       387         95         39         17 |       538 
           |     71.93      17.66       7.25       3.16 |    100.00 
-----------+--------------------------------------------+----------
     Total |   136,377     35,177     15,035      7,697 |   194,286 
           |     70.19      18.11       7.74       3.96 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |       Diagnosed
 ONS covid |     hypertension
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   110,873     82,875 |   193,748 
           |     57.23      42.77 |    100.00 
-----------+----------------------+----------
         1 |       175        363 |       538 
           |     32.53      67.47 |    100.00 
-----------+----------------------+----------
     Total |   111,048     83,238 |   194,286 
           |     57.16      42.84 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
 ONS covid |        Cancer
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   173,874     19,874 |   193,748 
           |     89.74      10.26 |    100.00 
-----------+----------------------+----------
         1 |       430        108 |       538 
           |     79.93      20.07 |    100.00 
-----------+----------------------+----------
     Total |   174,304     19,982 |   194,286 
           |     89.72      10.28 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |     Neurological
       for |      conditions
  outcome: | (stroke+dementia+othe
 ONS covid |          r)
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   181,159     12,589 |   193,748 
           |     93.50       6.50 |    100.00 
-----------+----------------------+----------
         1 |       431        107 |       538 
           |     80.11      19.89 |    100.00 
-----------+----------------------+----------
     Total |   181,590     12,696 |   194,286 
           |     93.47       6.53 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
 ONS covid |      Flu vaccine
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |    72,108    121,640 |   193,748 
           |     37.22      62.78 |    100.00 
-----------+----------------------+----------
         1 |       122        416 |       538 
           |     22.68      77.32 |    100.00 
-----------+----------------------+----------
     Total |    72,230    122,056 |   194,286 
           |     37.18      62.82 |    100.00 

. 
. foreach var in $varlist                                 {
  2.         local var: subinstr local var "i." ""   
  3.         tab onsnoncoviddeath `var', row 
  4. }

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |
 non-covid |     HCQ Exposure
     death |    No HCQ        HCQ |     Total
-----------+----------------------+----------
         0 |   162,198     30,299 |   192,497 
           |     84.26      15.74 |    100.00 
-----------+----------------------+----------
         1 |     1,576        213 |     1,789 
           |     88.09      11.91 |    100.00 
-----------+----------------------+----------
     Total |   163,774     30,512 |   194,286 
           |     84.30      15.70 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |
 non-covid |         Male
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   137,027     55,470 |   192,497 
           |     71.18      28.82 |    100.00 
-----------+----------------------+----------
         1 |     1,176        613 |     1,789 
           |     65.74      34.26 |    100.00 
-----------+----------------------+----------
     Total |   138,203     56,083 |   194,286 
           |     71.13      28.87 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |
 non-covid |                      Grouped age
     death |    18-<40     40-<50     50-<60     60-<70     70-<80 |     Total
-----------+-------------------------------------------------------+----------
         0 |    13,678     19,398     36,961     45,439     48,575 |   192,497 
           |      7.11      10.08      19.20      23.61      25.23 |    100.00 
-----------+-------------------------------------------------------+----------
         1 |         8         13         58        196        540 |     1,789 
           |      0.45       0.73       3.24      10.96      30.18 |    100.00 
-----------+-------------------------------------------------------+----------
     Total |    13,686     19,411     37,019     45,635     49,115 |   194,286 
           |      7.04       9.99      19.05      23.49      25.28 |    100.00 


Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |  Grouped
 non-covid |    age
     death |       80+ |     Total
-----------+-----------+----------
         0 |    28,446 |   192,497 
           |     14.78 |    100.00 
-----------+-----------+----------
         1 |       974 |     1,789 
           |     54.44 |    100.00 
-----------+-----------+----------
     Total |    29,420 |   194,286 
           |     15.14 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |
 non-covid |      DMARD (PC)
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   121,623     70,874 |   192,497 
           |     63.18      36.82 |    100.00 
-----------+----------------------+----------
         1 |     1,291        498 |     1,789 
           |     72.16      27.84 |    100.00 
-----------+----------------------+----------
     Total |   122,914     71,372 |   194,286 
           |     63.26      36.74 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |
 non-covid |          OCS
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   159,503     32,994 |   192,497 
           |     82.86      17.14 |    100.00 
-----------+----------------------+----------
         1 |     1,182        607 |     1,789 
           |     66.07      33.93 |    100.00 
-----------+----------------------+----------
     Total |   160,685     33,601 |   194,286 
           |     82.71      17.29 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |    Chronic cardiac
 non-covid |        disease
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   162,727     29,770 |   192,497 
           |     84.53      15.47 |    100.00 
-----------+----------------------+----------
         1 |     1,011        778 |     1,789 
           |     56.51      43.49 |    100.00 
-----------+----------------------+----------
     Total |   163,738     30,548 |   194,286 
           |     84.28      15.72 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |  Respiratory disease
 non-covid |     (excl asthma)
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   166,431     26,066 |   192,497 
           |     86.46      13.54 |    100.00 
-----------+----------------------+----------
         1 |     1,231        558 |     1,789 
           |     68.81      31.19 |    100.00 
-----------+----------------------+----------
     Total |   167,662     26,624 |   194,286 
           |     86.30      13.70 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS | Calculated eGFR (missing set to
 non-covid |              norm)
     death | >=60/miss      30-59        <30 |     Total
-----------+---------------------------------+----------
         0 |   167,431     23,301      1,765 |   192,497 
           |     86.98      12.10       0.92 |    100.00 
-----------+---------------------------------+----------
         1 |     1,160        507        122 |     1,789 
           |     64.84      28.34       6.82 |    100.00 
-----------+---------------------------------+----------
     Total |   168,591     23,808      1,887 |   194,286 
           |     86.77      12.25       0.97 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |
 non-covid | Chronic liver disease
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   189,836      2,661 |   192,497 
           |     98.62       1.38 |    100.00 
-----------+----------------------+----------
         1 |     1,741         48 |     1,789 
           |     97.32       2.68 |    100.00 
-----------+----------------------+----------
     Total |   191,577      2,709 |   194,286 
           |     98.61       1.39 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |
 non-covid |     Evidence of obesity (4 categories)
     death | No record  Obese I (  Obese II   Obese III |     Total
-----------+--------------------------------------------+----------
         0 |   134,948     34,961     14,935      7,653 |   192,497 
           |     70.10      18.16       7.76       3.98 |    100.00 
-----------+--------------------------------------------+----------
         1 |     1,429        216        100         44 |     1,789 
           |     79.88      12.07       5.59       2.46 |    100.00 
-----------+--------------------------------------------+----------
     Total |   136,377     35,177     15,035      7,697 |   194,286 
           |     70.19      18.11       7.74       3.96 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |       Diagnosed
 non-covid |     hypertension
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   110,462     82,035 |   192,497 
           |     57.38      42.62 |    100.00 
-----------+----------------------+----------
         1 |       586      1,203 |     1,789 
           |     32.76      67.24 |    100.00 
-----------+----------------------+----------
     Total |   111,048     83,238 |   194,286 
           |     57.16      42.84 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |
 non-covid |        Cancer
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   173,044     19,453 |   192,497 
           |     89.89      10.11 |    100.00 
-----------+----------------------+----------
         1 |     1,260        529 |     1,789 
           |     70.43      29.57 |    100.00 
-----------+----------------------+----------
     Total |   174,304     19,982 |   194,286 
           |     89.72      10.28 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |     Neurological
  outcome: |      conditions
       ONS | (stroke+dementia+othe
 non-covid |          r)
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   180,188     12,309 |   192,497 
           |     93.61       6.39 |    100.00 
-----------+----------------------+----------
         1 |     1,402        387 |     1,789 
           |     78.37      21.63 |    100.00 
-----------+----------------------+----------
     Total |   181,590     12,696 |   194,286 
           |     93.47       6.53 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |
 non-covid |      Flu vaccine
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |    71,786    120,711 |   192,497 
           |     37.29      62.71 |    100.00 
-----------+----------------------+----------
         1 |       444      1,345 |     1,789 
           |     24.82      75.18 |    100.00 
-----------+----------------------+----------
     Total |    72,230    122,056 |   194,286 
           |     37.18      62.82 |    100.00 

. 
. 
. * Close log file 
. log close
      name:  <unnamed>
       log:  E:\analyses\hydroxychloroquine-research/output/log\03_an_checks.lo
> g
  log type:  text
 closed on:  21 Jul 2020, 14:33:01
-------------------------------------------------------------------------------
