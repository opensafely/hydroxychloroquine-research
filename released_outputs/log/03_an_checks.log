-------------------------------------------------------------------------------
      name:  <unnamed>
       log:  E:\analyses\hydroxychloroquine-research/output/log\03_an_checks.lo
> g
  log type:  text
 opened on:  19 Jul 2020, 20:27:47

. 
. * Open Stata dataset
. use $Tempdir\analysis_dataset, clear

. 
. 
. *Duplicate patient check
. datacheck _n==1, by(patient_id) nol

. 
. /* EXPECTED VALUES===========================================================
> =*/ 
. 
. * Age
. datacheck age<., nol

. datacheck inlist(agegroup, 1, 2, 3, 4, 5, 6), nol

. datacheck inlist(age70, 0, 1), nol

. 
. * Sex
. datacheck inlist(male, 0, 1), nol

. 
. * BMI 
. datacheck inlist(obese4cat, 1, 2, 3, 4), nol

. datacheck inlist(bmicat, 1, 2, 3, 4, 5, 6, .u), nol

. 
. * IMD
. datacheck inlist(imd, 1, 2, 3, 4, 5), nol

. 
. * Residence type
. datacheck inlist(residence_type, 1, 2, 3, 4, 5, 6, 7, 8, .u), nol

. 
. * Ethnicity
. datacheck inlist(ethnicity, 1, 2, 3, 4, 5, .u), nol

. 
. * Smoking
. datacheck inlist(smoke, 1, 2, 3, .u), nol

. datacheck inlist(smoke_nomiss, 1, 2, 3), nol 

. 
. 
. 
. * Check date ranges for all treatment variables   
. foreach var of varlist  hcq                                     ///
>                                                 dmard_pc                ///
>                                                 oral_prednisolone       ///
>                                                 nsaids                       
>    ///
>                                                 azith                        
>    ///
>          {
  2.                                                 
.         tab `var', missing                                      
  3.         summ `var'_date, format
  4. 
. }

        HCQ |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    163,735       84.30       84.30
          1 |     30,501       15.70      100.00
------------+-----------------------------------
      Total |    194,236      100.00

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
    hcq_date |     33,813   22jan2020    36.90127  15sep2019  15feb2020

 DMARD (PC) |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    122,894       63.27       63.27
          1 |     71,342       36.73      100.00
------------+-----------------------------------
      Total |    194,236      100.00

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
dmard_pc_d~e |     75,591   30jan2020    31.47817  15sep2019  15feb2020

        OCS |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    160,643       82.71       82.71
          1 |     33,593       17.29      100.00
------------+-----------------------------------
      Total |    194,236      100.00

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
oral_pred~te |     33,593   11jan2020    44.88931  15sep2019  15feb2020

     NSAIDs |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    160,980       82.88       82.88
          1 |     33,256       17.12      100.00
------------+-----------------------------------
      Total |    194,236      100.00

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
 nsaids_date |     33,256   08jan2020    47.03833  15sep2019  15feb2020

Azithromyci |
          n |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    193,288       99.51       99.51
          1 |        948        0.49      100.00
------------+-----------------------------------
      Total |    194,236      100.00

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
  azith_date |        948   14feb2020    4.457296  15jan2020  15feb2020

. 
. * Check date ranges for all comorbidities 
. foreach var of varlist  chronic_cardiac_disease_date    ///
>                                                 chronic_liver_disease_date   
>            ///
>                                                 egfr_date                    
>                    ///
>                                                 hypertension_date            
>                    ///
>                                                 diabetes_date                
>                    ///
>                                                 cancer_ever_date             
>                    ///
>                                                 perm_immunodef_date          
>                    ///
>                                                 temp_immunodef_date          
>                    ///
>                                                 hba1c_mmol_per_mol_date      
>            ///
>                                                 hba1c_percentage_date        
>            ///
>                                                 resp_excl_asthma_date        
>            ///     
>                                                 current_asthma_date          
>                    ///
>                                                 neuro_conditions_date        
>            ///
>                                                 rheumatoid_date              
>                    ///
>                                                 sle_date        { 
  2.                                                 
.         summ `var', format
  3. 
. }

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_c~te |     30,540   27jul2006    6936.845  15dec1840  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
chronic_l~te |      2,709   28feb2008    6543.454  15jan1900  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
   egfr_date |    152,864   21nov2019    93.18302  15feb2019  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
hypertensi~e |     83,215   27jan2003    7515.388  15jan1850  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
diabetes_d~e |     34,733   24nov2007    6675.584  15sep1899  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
cancer_eve~e |     19,962   20nov2008    4861.947  15dec1899  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
perm_immun~e |      2,083   21jul2006    6310.606  15jan1900  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
temp_immun~e |        896   16oct2019    100.2184  15mar2019  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
hba1c_mmol~e |    152,120   24nov2018    545.6808  15feb1995  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
hba1c_perc~e |     69,964   27feb2016    1549.891  15jan1900  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
resp_excl_~e |     26,617   10feb2008    7019.636  15jan1800  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
current_as~e |     38,524   04sep1994    9399.981  15jan1800  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
neuro_cond~e |     12,686   25jan2008    6485.803  15dec1899  15feb2020

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
rheumatoid~e |    168,613   16jan2005    7255.003  15jan1800  15aug2019

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
    sle_date |     28,276   29jun2001    7486.585  15dec1899  15aug2019

. 
. 
. 
. * Outcome dates
. summ  died_date_onscovid died_date_onsnoncovid first_pos_test_sgss first_pos_
> test_primcare, format

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
died_~scovid |        539   24apr2020    20.53657  15mar2020  01jul2020
died_~ncovid |      1,818   27apr2020    34.94826  02mar2020  06jul2020
first_pos_~s |      1,338   23apr2020    24.87733  03mar2020  08jul2020
first_pos_~e |      1,342   22apr2020     101.263  07feb2014  08jul2020

. 
. * Censoring dates
. summ  onscoviddeathcensor_date hcq_first_after_date, format

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
onscovidde~e |    194,236   29jun2020           0  29jun2020  29jun2020
hcq_first_~e |      2,892   14apr2020    34.50811  02mar2020  09jul2020

. 
. * Last dates
. summ  stime_onscoviddeath stime_onsnoncoviddeath stime_firstpos_sgss stime_fi
> rstpos_primcare,   format

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
stime_onsc~h |    194,236   27jun2020     12.6492  02mar2020  29jun2020
stime_onsn~h |    194,236   27jun2020     12.6492  02mar2020  29jun2020
stime_firs~s |    194,236   05jul2020    14.98095  02mar2020  08jul2020
stime_firs~e |    194,236   05jul2020    17.25077  07feb2014  08jul2020

. 
. 
. 
. 
. /* FREQUENCIES ==============================================================
> =*/ 
. * Check frequency of all variables in fully adjusted model 
. foreach comorb in $varlist { 
  2. 
.         local comorb: subinstr local comorb "i." ""
  3.         tab `comorb', m
  4.         
. }

        HCQ |
   Exposure |      Freq.     Percent        Cum.
------------+-----------------------------------
     No HCQ |    163,735       84.30       84.30
        HCQ |     30,501       15.70      100.00
------------+-----------------------------------
      Total |    194,236      100.00

       Male |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    138,160       71.13       71.13
          1 |     56,076       28.87      100.00
------------+-----------------------------------
      Total |    194,236      100.00

Grouped age |      Freq.     Percent        Cum.
------------+-----------------------------------
     18-<40 |     13,683        7.04        7.04
     40-<50 |     19,406        9.99       17.04
     50-<60 |     37,024       19.06       36.10
     60-<70 |     45,617       23.49       59.58
     70-<80 |     49,101       25.28       84.86
        80+ |     29,405       15.14      100.00
------------+-----------------------------------
      Total |    194,236      100.00

 DMARD (PC) |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    122,894       63.27       63.27
          1 |     71,342       36.73      100.00
------------+-----------------------------------
      Total |    194,236      100.00

        OCS |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    160,643       82.71       82.71
          1 |     33,593       17.29      100.00
------------+-----------------------------------
      Total |    194,236      100.00

    Chronic |
    cardiac |
    disease |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    163,696       84.28       84.28
          1 |     30,540       15.72      100.00
------------+-----------------------------------
      Total |    194,236      100.00

Respiratory |
    disease |
      (excl |
    asthma) |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    167,619       86.30       86.30
          1 |     26,617       13.70      100.00
------------+-----------------------------------
      Total |    194,236      100.00

  Calculated |
        eGFR |
(missing set |
    to norm) |      Freq.     Percent        Cum.
-------------+-----------------------------------
>=60/missing |    168,549       86.78       86.78
       30-59 |     23,802       12.25       99.03
         <30 |      1,885        0.97      100.00
-------------+-----------------------------------
       Total |    194,236      100.00

    Chronic |
      liver |
    disease |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    191,527       98.61       98.61
          1 |      2,709        1.39      100.00
------------+-----------------------------------
      Total |    194,236      100.00

 Evidence of obesity |
      (4 categories) |      Freq.     Percent        Cum.
---------------------+-----------------------------------
No record of obesity |    136,347       70.20       70.20
   Obese I (30-34.9) |     35,166       18.10       88.30
  Obese II (35-39.9) |     15,035        7.74       96.04
     Obese III (40+) |      7,688        3.96      100.00
---------------------+-----------------------------------
               Total |    194,236      100.00

  Diagnosed |
hypertensio |
          n |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    111,021       57.16       57.16
          1 |     83,215       42.84      100.00
------------+-----------------------------------
      Total |    194,236      100.00

     Cancer |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    174,274       89.72       89.72
          1 |     19,962       10.28      100.00
------------+-----------------------------------
      Total |    194,236      100.00

Neurologica |
          l |
 conditions |
(stroke+dem |
entia+other |
          ) |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |    181,550       93.47       93.47
          1 |     12,686        6.53      100.00
------------+-----------------------------------
      Total |    194,236      100.00

Flu vaccine |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |     72,231       37.19       37.19
          1 |    122,005       62.81      100.00
------------+-----------------------------------
      Total |    194,236      100.00

. 
. 
. 
. /* LOGICAL RELATIONSHIPS=====================================================
> =*/ 
. 
. * BMI
. bysort bmicat: summ bmi

-------------------------------------------------------------------------------
-> bmicat = Underweight (<18.5)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |      4,452    17.27549    .9032028         15       18.4

-------------------------------------------------------------------------------
-> bmicat = Normal (18.5-24.9)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |     57,178    22.39087    1.714422       18.5       24.9

-------------------------------------------------------------------------------
-> bmicat = Overweight (25-29.9)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |     61,723     27.3151    1.414451         25       29.9

-------------------------------------------------------------------------------
-> bmicat = Obese I (30-34.9)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |     35,166    32.13567    1.426333         30       34.9

-------------------------------------------------------------------------------
-> bmicat = Obese II (35-39.9)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |     15,035    37.08335    1.412117         35       39.9

-------------------------------------------------------------------------------
-> bmicat = Obese III (40+)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |      7,688    43.38885    2.646112         40         50

-------------------------------------------------------------------------------
-> bmicat = Unknown (.u)

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         bmi |          0


. tab bmicat obese4cat, m

                     |     Evidence of obesity (4 categories)
         Grouped BMI | No record  Obese I (  Obese II   Obese III |     Total
---------------------+--------------------------------------------+----------
 Underweight (<18.5) |     4,452          0          0          0 |     4,452 
  Normal (18.5-24.9) |    57,178          0          0          0 |    57,178 
Overweight (25-29.9) |    61,723          0          0          0 |    61,723 
   Obese I (30-34.9) |         0     35,166          0          0 |    35,166 
  Obese II (35-39.9) |         0          0     15,035          0 |    15,035 
     Obese III (40+) |         0          0          0      7,688 |     7,688 
        Unknown (.u) |    12,994          0          0          0 |    12,994 
---------------------+--------------------------------------------+----------
               Total |   136,347     35,166     15,035      7,688 |   194,236 

. 
. * Age
. bysort agegroup: summ age

-------------------------------------------------------------------------------
-> agegroup = 18-<40

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |     13,683    32.21128    5.466929         18         39

-------------------------------------------------------------------------------
-> agegroup = 40-<50

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |     19,406    45.18577    2.862919         40         49

-------------------------------------------------------------------------------
-> agegroup = 50-<60

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |     37,024    54.86225     2.82595         50         59

-------------------------------------------------------------------------------
-> agegroup = 60-<70

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |     45,617    64.60543    2.867535         60         69

-------------------------------------------------------------------------------
-> agegroup = 70-<80

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |     49,101    74.16112    2.774118         70         79

-------------------------------------------------------------------------------
-> agegroup = 80+

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         age |     29,405    84.83312    4.155232         80        110


. tab agegroup age70, m

   Grouped |  70 years and older
       age |         0          1 |     Total
-----------+----------------------+----------
    18-<40 |    13,683          0 |    13,683 
    40-<50 |    19,406          0 |    19,406 
    50-<60 |    37,024          0 |    37,024 
    60-<70 |    45,617          0 |    45,617 
    70-<80 |         0     49,101 |    49,101 
       80+ |         0     29,405 |    29,405 
-----------+----------------------+----------
     Total |   115,730     78,506 |   194,236 

. 
. * Smoking
. tab smoke smoke_nomiss, m

             |  Smoking status (missing set to
     Smoking |               non)
      status |     Never     Former    Current |     Total
-------------+---------------------------------+----------
       Never |    74,031          0          0 |    74,031 
      Former |         0     92,235          0 |    92,235 
     Current |         0          0     27,360 |    27,360 
Unknown (.u) |       610          0          0 |       610 
-------------+---------------------------------+----------
       Total |    74,641     92,235     27,360 |   194,236 

. 
. * Diabetes
. tab diabcat diabetes, m

                      |       Diabetes
    Diabetes Severity |         0          1 |     Total
----------------------+----------------------+----------
          No diabetes |   159,503          0 |   159,503 
  Controlled diabetes |         0     24,809 |    24,809 
Uncontrolled diabetes |         0      9,363 |     9,363 
Diabetes, no hba1c me |         0        561 |       561 
----------------------+----------------------+----------
                Total |   159,503     34,733 |   194,236 

. 
. * eGFR
. tab egfr_cat_nomiss egfr_cat, m

  Calculated |
        eGFR |
(missing set |               Calculated eGFR
    to norm) |      >=60      30-59        <30  Unknown ( |     Total
-------------+--------------------------------------------+----------
>=60/missing |   127,177          0          0     41,372 |   168,549 
       30-59 |         0     23,802          0          0 |    23,802 
         <30 |         0          0      1,885          0 |     1,885 
-------------+--------------------------------------------+----------
       Total |   127,177     23,802      1,885     41,372 |   194,236 

. 
. * urban residence
. *tab residence_type urban, m
. 
. 
. 
. 
. /* EXPECTED RELATIONSHIPS====================================================
> =*/ 
. 
. /*  Relationships between demographic/lifestyle variables  */
. 
. // tab agegroup bmicat,         row 
. // tab agegroup smoke,  row  
. // tab agegroup ethnicity, row 
. // tab agegroup imd,            row 
. //
. // tab bmicat smoke,             row   
. // tab bmicat ethnicity,         row 
. // tab bmicat imd,               row 
. // tab bmicat hypertension, row 
. //                            
. // tab smoke ethnicity,         row 
. // tab smoke imd,                       row 
. // tab smoke hypertension, row 
. //                            
. // tab ethnicity imd,           row 
. //
. // * Relationships with age
. // foreach var in $varlist                              {
. //      local var: subinstr local var "i." ""
. //      tab agegroup `var', row 
. //  }
. //
. //
. //  * Relationships with sex
. // foreach var in $varlist                                      {
. //      local var: subinstr local var "i." ""                                
>            
. //      tab male `var', row 
. // }
. //
. //  * Relationships with smoking
. // foreach var in $varlist                              {
. //      local var: subinstr local var "i." ""   
. //      tab smoke `var', row 
. // }
. 
. 
. 
. /* CROSS TABS================================================================
> =*/ 
. /* Treatment variables */ 
. foreach var of varlist  hcq                                     ///
>                                                 dmard_pc                     
>    ///
>                                                 azith                   ///
>                                                 oral_prednisolone       ///
>                                                 {
  2.                                                 
.         tab exposure `var', row col missing
  3. 
. }

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

       HCQ |          HCQ
  Exposure |         0          1 |     Total
-----------+----------------------+----------
    No HCQ |   163,735          0 |   163,735 
           |    100.00       0.00 |    100.00 
           |    100.00       0.00 |     84.30 
-----------+----------------------+----------
       HCQ |         0     30,501 |    30,501 
           |      0.00     100.00 |    100.00 
           |      0.00     100.00 |     15.70 
-----------+----------------------+----------
     Total |   163,735     30,501 |   194,236 
           |     84.30      15.70 |    100.00 
           |    100.00     100.00 |    100.00 

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

       HCQ |      DMARD (PC)
  Exposure |         0          1 |     Total
-----------+----------------------+----------
    No HCQ |   108,097     55,638 |   163,735 
           |     66.02      33.98 |    100.00 
           |     87.96      77.99 |     84.30 
-----------+----------------------+----------
       HCQ |    14,797     15,704 |    30,501 
           |     48.51      51.49 |    100.00 
           |     12.04      22.01 |     15.70 
-----------+----------------------+----------
     Total |   122,894     71,342 |   194,236 
           |     63.27      36.73 |    100.00 
           |    100.00     100.00 |    100.00 

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

       HCQ |     Azithromycin
  Exposure |         0          1 |     Total
-----------+----------------------+----------
    No HCQ |   162,984        751 |   163,735 
           |     99.54       0.46 |    100.00 
           |     84.32      79.22 |     84.30 
-----------+----------------------+----------
       HCQ |    30,304        197 |    30,501 
           |     99.35       0.65 |    100.00 
           |     15.68      20.78 |     15.70 
-----------+----------------------+----------
     Total |   193,288        948 |   194,236 
           |     99.51       0.49 |    100.00 
           |    100.00     100.00 |    100.00 

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

       HCQ |          OCS
  Exposure |         0          1 |     Total
-----------+----------------------+----------
    No HCQ |   137,008     26,727 |   163,735 
           |     83.68      16.32 |    100.00 
           |     85.29      79.56 |     84.30 
-----------+----------------------+----------
       HCQ |    23,635      6,866 |    30,501 
           |     77.49      22.51 |    100.00 
           |     14.71      20.44 |     15.70 
-----------+----------------------+----------
     Total |   160,643     33,593 |   194,236 
           |     82.71      17.29 |    100.00 
           |    100.00     100.00 |    100.00 

. 
. /* AGE/SEX DISTRIBUTION BY HCQ USE      =====================================
> =*/
. tab agegroup sex if hcq == 1,m

   Grouped |          Sex
       age |         F          M |     Total
-----------+----------------------+----------
    18-<40 |     2,009        265 |     2,274 
    40-<50 |     3,096        506 |     3,602 
    50-<60 |     5,288      1,328 |     6,616 
    60-<70 |     5,850      2,112 |     7,962 
    70-<80 |     4,998      2,127 |     7,125 
       80+ |     2,053        869 |     2,922 
-----------+----------------------+----------
     Total |    23,294      7,207 |    30,501 

. tab agegroup sex if hcq == 0,m

   Grouped |          Sex
       age |         F          M |     Total
-----------+----------------------+----------
    18-<40 |     8,487      2,922 |    11,409 
    40-<50 |    11,553      4,251 |    15,804 
    50-<60 |    21,514      8,894 |    30,408 
    60-<70 |    26,136     11,519 |    37,655 
    70-<80 |    28,451     13,525 |    41,976 
       80+ |    18,725      7,758 |    26,483 
-----------+----------------------+----------
     Total |   114,866     48,869 |   163,735 

. 
. 
. /* SENSE CHECK POPULATIONS===================================================
> =*/
. tab rheumatoid sle, row col

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

           |          SLE
        RA |         0          1 |     Total
-----------+----------------------+----------
         0 |         0     25,623 |    25,623 
           |      0.00     100.00 |    100.00 
           |      0.00      90.62 |     13.19 
-----------+----------------------+----------
         1 |   165,960      2,653 |   168,613 
           |     98.43       1.57 |    100.00 
           |    100.00       9.38 |     86.81 
-----------+----------------------+----------
     Total |   165,960     28,276 |   194,236 
           |     85.44      14.56 |    100.00 
           |    100.00     100.00 |    100.00 

. tab population, m

 Population |      Freq.     Percent        Cum.
------------+-----------------------------------
         RA |    167,513       86.24       86.24
        SLE |     26,723       13.76      100.00
------------+-----------------------------------
      Total |    194,236      100.00

. tab population rheumatoid, m

           |          RA
Population |         0          1 |     Total
-----------+----------------------+----------
        RA |         0    167,513 |   167,513 
       SLE |    25,623      1,100 |    26,723 
-----------+----------------------+----------
     Total |    25,623    168,613 |   194,236 

. tab population sle, m

           |          SLE
Population |         0          1 |     Total
-----------+----------------------+----------
        RA |   165,960      1,553 |   167,513 
       SLE |         0     26,723 |    26,723 
-----------+----------------------+----------
     Total |   165,960     28,276 |   194,236 

. 
. 
. /* SENSE CHECK OUTCOMES======================================================
> =*/
. tab firstpos_sgss firstpos_primcare, row col

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

Failure/ce |
   nsoring |
 indicator |
       for |   Failure/censoring
  outcome: |     indicator for
      SGSS | outcome: primary care
  positive |     positive test
      test |         0          1 |     Total
-----------+----------------------+----------
         0 |   192,292        606 |   192,898 
           |     99.69       0.31 |    100.00 
           |     99.69      45.16 |     99.31 
-----------+----------------------+----------
         1 |       602        736 |     1,338 
           |     44.99      55.01 |    100.00 
           |      0.31      54.84 |      0.69 
-----------+----------------------+----------
     Total |   192,894      1,342 |   194,236 
           |     99.31       0.69 |    100.00 
           |    100.00     100.00 |    100.00 

. tab onscoviddeath onsnoncoviddeath, row col

+-------------------+
| Key               |
|-------------------|
|     frequency     |
|  row percentage   |
| column percentage |
+-------------------+

Failure/ce |
   nsoring |
 indicator |   Failure/censoring
       for |     indicator for
  outcome: |     outcome: ONS
 ONS covid |    non-covid death
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   191,908      1,790 |   193,698 
           |     99.08       0.92 |    100.00 
           |     99.72     100.00 |     99.72 
-----------+----------------------+----------
         1 |       538          0 |       538 
           |    100.00       0.00 |    100.00 
           |      0.28       0.00 |      0.28 
-----------+----------------------+----------
     Total |   192,446      1,790 |   194,236 
           |     99.08       0.92 |    100.00 
           |    100.00     100.00 |    100.00 

. 
. /* ENSURE ENOUGH DEATHS IN EACH CATEGORY INCLUDED IN FULLY ADJUSTED MODEL ===
> =*/
. foreach var in $varlist                                 {
  2.         local var: subinstr local var "i." ""   
  3.         tab onscoviddeath `var', row 
  4. }

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
 ONS covid |     HCQ Exposure
     death |    No HCQ        HCQ |     Total
-----------+----------------------+----------
         0 |   163,265     30,433 |   193,698 
           |     84.29      15.71 |    100.00 
-----------+----------------------+----------
         1 |       470         68 |       538 
           |     87.36      12.64 |    100.00 
-----------+----------------------+----------
     Total |   163,735     30,501 |   194,236 
           |     84.30      15.70 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
 ONS covid |         Male
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   137,825     55,873 |   193,698 
           |     71.15      28.85 |    100.00 
-----------+----------------------+----------
         1 |       335        203 |       538 
           |     62.27      37.73 |    100.00 
-----------+----------------------+----------
     Total |   138,160     56,076 |   194,236 
           |     71.13      28.87 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
 ONS covid |                      Grouped age
     death |    18-<40     40-<50     50-<60     60-<70     70-<80 |     Total
-----------+-------------------------------------------------------+----------
         0 |    13,683     19,399     37,007     45,568     48,931 |   193,698 
           |      7.06      10.02      19.11      23.53      25.26 |    100.00 
-----------+-------------------------------------------------------+----------
         1 |         0          7         17         49        170 |       538 
           |      0.00       1.30       3.16       9.11      31.60 |    100.00 
-----------+-------------------------------------------------------+----------
     Total |    13,683     19,406     37,024     45,617     49,101 |   194,236 
           |      7.04       9.99      19.06      23.49      25.28 |    100.00 


Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |  Grouped
 ONS covid |    age
     death |       80+ |     Total
-----------+-----------+----------
         0 |    29,110 |   193,698 
           |     15.03 |    100.00 
-----------+-----------+----------
         1 |       295 |       538 
           |     54.83 |    100.00 
-----------+-----------+----------
     Total |    29,405 |   194,236 
           |     15.14 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
 ONS covid |      DMARD (PC)
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   122,547     71,151 |   193,698 
           |     63.27      36.73 |    100.00 
-----------+----------------------+----------
         1 |       347        191 |       538 
           |     64.50      35.50 |    100.00 
-----------+----------------------+----------
     Total |   122,894     71,342 |   194,236 
           |     63.27      36.73 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
 ONS covid |          OCS
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   160,316     33,382 |   193,698 
           |     82.77      17.23 |    100.00 
-----------+----------------------+----------
         1 |       327        211 |       538 
           |     60.78      39.22 |    100.00 
-----------+----------------------+----------
     Total |   160,643     33,593 |   194,236 
           |     82.71      17.29 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |    Chronic cardiac
 ONS covid |        disease
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   163,376     30,322 |   193,698 
           |     84.35      15.65 |    100.00 
-----------+----------------------+----------
         1 |       320        218 |       538 
           |     59.48      40.52 |    100.00 
-----------+----------------------+----------
     Total |   163,696     30,540 |   194,236 
           |     84.28      15.72 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |  Respiratory disease
 ONS covid |     (excl asthma)
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   167,248     26,450 |   193,698 
           |     86.34      13.66 |    100.00 
-----------+----------------------+----------
         1 |       371        167 |       538 
           |     68.96      31.04 |    100.00 
-----------+----------------------+----------
     Total |   167,619     26,617 |   194,236 
           |     86.30      13.70 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: | Calculated eGFR (missing set to
 ONS covid |              norm)
     death | >=60/miss      30-59        <30 |     Total
-----------+---------------------------------+----------
         0 |   168,204     23,639      1,855 |   193,698 
           |     86.84      12.20       0.96 |    100.00 
-----------+---------------------------------+----------
         1 |       345        163         30 |       538 
           |     64.13      30.30       5.58 |    100.00 
-----------+---------------------------------+----------
     Total |   168,549     23,802      1,885 |   194,236 
           |     86.78      12.25       0.97 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
 ONS covid | Chronic liver disease
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   190,999      2,699 |   193,698 
           |     98.61       1.39 |    100.00 
-----------+----------------------+----------
         1 |       528         10 |       538 
           |     98.14       1.86 |    100.00 
-----------+----------------------+----------
     Total |   191,527      2,709 |   194,236 
           |     98.61       1.39 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
 ONS covid |     Evidence of obesity (4 categories)
     death | No record  Obese I (  Obese II   Obese III |     Total
-----------+--------------------------------------------+----------
         0 |   135,960     35,071     14,996      7,671 |   193,698 
           |     70.19      18.11       7.74       3.96 |    100.00 
-----------+--------------------------------------------+----------
         1 |       387         95         39         17 |       538 
           |     71.93      17.66       7.25       3.16 |    100.00 
-----------+--------------------------------------------+----------
     Total |   136,347     35,166     15,035      7,688 |   194,236 
           |     70.20      18.10       7.74       3.96 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |       Diagnosed
 ONS covid |     hypertension
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   110,846     82,852 |   193,698 
           |     57.23      42.77 |    100.00 
-----------+----------------------+----------
         1 |       175        363 |       538 
           |     32.53      67.47 |    100.00 
-----------+----------------------+----------
     Total |   111,021     83,215 |   194,236 
           |     57.16      42.84 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
 ONS covid |        Cancer
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   173,844     19,854 |   193,698 
           |     89.75      10.25 |    100.00 
-----------+----------------------+----------
         1 |       430        108 |       538 
           |     79.93      20.07 |    100.00 
-----------+----------------------+----------
     Total |   174,274     19,962 |   194,236 
           |     89.72      10.28 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |     Neurological
       for |      conditions
  outcome: | (stroke+dementia+othe
 ONS covid |          r)
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   181,119     12,579 |   193,698 
           |     93.51       6.49 |    100.00 
-----------+----------------------+----------
         1 |       431        107 |       538 
           |     80.11      19.89 |    100.00 
-----------+----------------------+----------
     Total |   181,550     12,686 |   194,236 
           |     93.47       6.53 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
 ONS covid |      Flu vaccine
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |    72,109    121,589 |   193,698 
           |     37.23      62.77 |    100.00 
-----------+----------------------+----------
         1 |       122        416 |       538 
           |     22.68      77.32 |    100.00 
-----------+----------------------+----------
     Total |    72,231    122,005 |   194,236 
           |     37.19      62.81 |    100.00 

. 
. foreach var in $varlist                                 {
  2.         local var: subinstr local var "i." ""   
  3.         tab onsnoncoviddeath `var', row 
  4. }

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |
 non-covid |     HCQ Exposure
     death |    No HCQ        HCQ |     Total
-----------+----------------------+----------
         0 |   162,158     30,288 |   192,446 
           |     84.26      15.74 |    100.00 
-----------+----------------------+----------
         1 |     1,577        213 |     1,790 
           |     88.10      11.90 |    100.00 
-----------+----------------------+----------
     Total |   163,735     30,501 |   194,236 
           |     84.30      15.70 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |
 non-covid |         Male
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   136,983     55,463 |   192,446 
           |     71.18      28.82 |    100.00 
-----------+----------------------+----------
         1 |     1,177        613 |     1,790 
           |     65.75      34.25 |    100.00 
-----------+----------------------+----------
     Total |   138,160     56,076 |   194,236 
           |     71.13      28.87 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |
 non-covid |                      Grouped age
     death |    18-<40     40-<50     50-<60     60-<70     70-<80 |     Total
-----------+-------------------------------------------------------+----------
         0 |    13,675     19,393     36,966     45,421     48,561 |   192,446 
           |      7.11      10.08      19.21      23.60      25.23 |    100.00 
-----------+-------------------------------------------------------+----------
         1 |         8         13         58        196        540 |     1,790 
           |      0.45       0.73       3.24      10.95      30.17 |    100.00 
-----------+-------------------------------------------------------+----------
     Total |    13,683     19,406     37,024     45,617     49,101 |   194,236 
           |      7.04       9.99      19.06      23.49      25.28 |    100.00 


Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |  Grouped
 non-covid |    age
     death |       80+ |     Total
-----------+-----------+----------
         0 |    28,430 |   192,446 
           |     14.77 |    100.00 
-----------+-----------+----------
         1 |       975 |     1,790 
           |     54.47 |    100.00 
-----------+-----------+----------
     Total |    29,405 |   194,236 
           |     15.14 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |
 non-covid |      DMARD (PC)
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   121,602     70,844 |   192,446 
           |     63.19      36.81 |    100.00 
-----------+----------------------+----------
         1 |     1,292        498 |     1,790 
           |     72.18      27.82 |    100.00 
-----------+----------------------+----------
     Total |   122,894     71,342 |   194,236 
           |     63.27      36.73 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |
 non-covid |          OCS
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   159,460     32,986 |   192,446 
           |     82.86      17.14 |    100.00 
-----------+----------------------+----------
         1 |     1,183        607 |     1,790 
           |     66.09      33.91 |    100.00 
-----------+----------------------+----------
     Total |   160,643     33,593 |   194,236 
           |     82.71      17.29 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |    Chronic cardiac
 non-covid |        disease
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   162,684     29,762 |   192,446 
           |     84.53      15.47 |    100.00 
-----------+----------------------+----------
         1 |     1,012        778 |     1,790 
           |     56.54      43.46 |    100.00 
-----------+----------------------+----------
     Total |   163,696     30,540 |   194,236 
           |     84.28      15.72 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |  Respiratory disease
 non-covid |     (excl asthma)
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   166,387     26,059 |   192,446 
           |     86.46      13.54 |    100.00 
-----------+----------------------+----------
         1 |     1,232        558 |     1,790 
           |     68.83      31.17 |    100.00 
-----------+----------------------+----------
     Total |   167,619     26,617 |   194,236 
           |     86.30      13.70 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS | Calculated eGFR (missing set to
 non-covid |              norm)
     death | >=60/miss      30-59        <30 |     Total
-----------+---------------------------------+----------
         0 |   167,389     23,294      1,763 |   192,446 
           |     86.98      12.10       0.92 |    100.00 
-----------+---------------------------------+----------
         1 |     1,160        508        122 |     1,790 
           |     64.80      28.38       6.82 |    100.00 
-----------+---------------------------------+----------
     Total |   168,549     23,802      1,885 |   194,236 
           |     86.78      12.25       0.97 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |
 non-covid | Chronic liver disease
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   189,785      2,661 |   192,446 
           |     98.62       1.38 |    100.00 
-----------+----------------------+----------
         1 |     1,742         48 |     1,790 
           |     97.32       2.68 |    100.00 
-----------+----------------------+----------
     Total |   191,527      2,709 |   194,236 
           |     98.61       1.39 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |
 non-covid |     Evidence of obesity (4 categories)
     death | No record  Obese I (  Obese II   Obese III |     Total
-----------+--------------------------------------------+----------
         0 |   134,917     34,950     14,935      7,644 |   192,446 
           |     70.11      18.16       7.76       3.97 |    100.00 
-----------+--------------------------------------------+----------
         1 |     1,430        216        100         44 |     1,790 
           |     79.89      12.07       5.59       2.46 |    100.00 
-----------+--------------------------------------------+----------
     Total |   136,347     35,166     15,035      7,688 |   194,236 
           |     70.20      18.10       7.74       3.96 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |       Diagnosed
 non-covid |     hypertension
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   110,435     82,011 |   192,446 
           |     57.38      42.62 |    100.00 
-----------+----------------------+----------
         1 |       586      1,204 |     1,790 
           |     32.74      67.26 |    100.00 
-----------+----------------------+----------
     Total |   111,021     83,215 |   194,236 
           |     57.16      42.84 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |
 non-covid |        Cancer
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   173,013     19,433 |   192,446 
           |     89.90      10.10 |    100.00 
-----------+----------------------+----------
         1 |     1,261        529 |     1,790 
           |     70.45      29.55 |    100.00 
-----------+----------------------+----------
     Total |   174,274     19,962 |   194,236 
           |     89.72      10.28 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |     Neurological
  outcome: |      conditions
       ONS | (stroke+dementia+othe
 non-covid |          r)
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |   180,147     12,299 |   192,446 
           |     93.61       6.39 |    100.00 
-----------+----------------------+----------
         1 |     1,403        387 |     1,790 
           |     78.38      21.62 |    100.00 
-----------+----------------------+----------
     Total |   181,550     12,686 |   194,236 
           |     93.47       6.53 |    100.00 

+----------------+
| Key            |
|----------------|
|   frequency    |
| row percentage |
+----------------+

Failure/ce |
   nsoring |
 indicator |
       for |
  outcome: |
       ONS |
 non-covid |      Flu vaccine
     death |         0          1 |     Total
-----------+----------------------+----------
         0 |    71,787    120,659 |   192,446 
           |     37.30      62.70 |    100.00 
-----------+----------------------+----------
         1 |       444      1,346 |     1,790 
           |     24.80      75.20 |    100.00 
-----------+----------------------+----------
     Total |    72,231    122,005 |   194,236 
           |     37.19      62.81 |    100.00 

. 
. 
. * Close log file 
. log close
      name:  <unnamed>
       log:  E:\analyses\hydroxychloroquine-research/output/log\03_an_checks.lo
> g
  log type:  text
 closed on:  19 Jul 2020, 20:27:51
-------------------------------------------------------------------------------
